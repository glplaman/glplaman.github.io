import{a as p}from"./axios-Cm0UX6qg.js";import{N as h}from"./Notice-CoJLqVL-.js";import{_ as v,r as l,c as k,d as s,e as y,u as d,a as x}from"./index-CfvwQzZa.js";const N={class:"avatar"},I={class:"avatar-box"},U=["src"],b={__name:"SetupAvatar",props:{user:{type:Object,default:()=>({})}},setup(r){let o=l(!1),c=l("");const n=r;let i=l(null);const m=()=>{i.value.click()},f=e=>{console.log(e.target.files[0]);let t=e.target.files[0];g(t)},g=e=>{let t=new FormData;t.append("image",e),p.post("/api/uploadimg",t,{headers:{"Content-Type":"multipart/form-data"}}).then(a=>{console.log("then",a),_({usn:n.user.usn,ukey:"imgUrl",uvalue:a.data.data.url}),n.user.imgUrl=a.data.data.url}).catch(a=>{console.log("err",a)})},_=e=>{p.post("/user/modify",e).then(t=>{console.log("then",t),u("修改成功")}).catch(t=>{console.log("err",t),u("修改失败")})},u=e=>{o.value=!0,c.value=e,setTimeout(()=>{o.value=!1},3e3)};return(e,t)=>(x(),k("div",N,[s("div",I,[s("img",{src:r.user.imgUrl,alt:""},null,8,U),s("input",{type:"file",name:"image",ref_key:"ipt",ref:i,accept:"image/*",hidden:"",onChange:f},null,544),s("div",{class:"avatar-btn",onClick:m},"上传头像")]),y(h,{flag:d(o),tips:d(c)},null,8,["flag","tips"])]))}},S=v(b,[["__scopeId","data-v-d289af95"]]);export{S as default};
