import{_ as w,r as p,c as b,d as e,s as f,z as _,u as i,A as h,C as S,e as N,a as V,p as z,l as I}from"./index-DeD7qWbD.js";import{m as d}from"./md5.min-C_ofGdPy.js";import{a as U}from"./axios-Cm0UX6qg.js";import{N as k}from"./Notice-CLd6l0Sg.js";const c=l=>(z("data-v-915f059c"),l=l(),I(),l),q={class:"pass"},B={class:"item"},E=c(()=>e("div",null,"旧密码",-1)),M={class:"item"},P=c(()=>e("div",null,"新密码",-1)),T={class:"item"},j=c(()=>e("div",null,"确认新密码",-1)),A=c(()=>e("div",{class:"btn-group"},[e("button",{type:"submit"},"提交"),e("button",{type:"reset"},"取消")],-1)),C={__name:"SetupPass",props:{user:{type:Object,default:()=>({})}},setup(l){const m=l;let a=p(""),t=p(""),u=p(""),v=p(!1),g=p("");const x=()=>{if(m.user.upass!==d.md5(a.value)){console.log("pass not match"),n("旧密码错误");return}if(t.value!==u.value){console.log("new pass not consistent"),n("新密码不一致");return}if(t.value==a.value){console.log("pass not change"),n("新密码与旧密码相同");return}console.log(d.md5(t.value)),y({usn:m.user.usn,ukey:"upass",uvalue:d.md5(t.value)}),m.user.upass=d.md5(t.value)},y=r=>{U.post("/user/modify",r).then(s=>{console.log("then",s),n("修改成功")}).catch(s=>{console.log("err",s),n("修改失败")})},n=r=>{v.value=!0,g.value=r,setTimeout(()=>{v.value=!1},3e3)};return(r,s)=>(V(),b("div",q,[e("form",{onSubmit:S(x,["prevent"])},[e("div",B,[E,f(e("input",{type:"text",name:"oldupass",maxlength:"16",required:"","onUpdate:modelValue":s[0]||(s[0]=o=>h(a)?a.value=o:a=o),placeholder:"16个字符以内"},null,512),[[_,i(a),void 0,{lazy:!0}]])]),e("div",M,[P,f(e("input",{type:"text",name:"newpass",maxlength:"16",required:"","onUpdate:modelValue":s[1]||(s[1]=o=>h(t)?t.value=o:t=o),placeholder:"16个字符以内"},null,512),[[_,i(t),void 0,{lazy:!0}]])]),e("div",T,[j,f(e("input",{type:"text",name:"temppass",maxlength:"16","onUpdate:modelValue":s[2]||(s[2]=o=>h(u)?u.value=o:u=o),required:"",placeholder:"16个字符以内"},null,512),[[_,i(u),void 0,{lazy:!0}]])]),A],32),N(k,{flag:i(v),tips:i(g)},null,8,["flag","tips"])]))}},G=w(C,[["__scopeId","data-v-915f059c"]]);export{G as default};
