import{_ as b,r as p,c as w,k as e,q as _,s as f,u as i,y as h,A as S,d as N,a as V,p as k,j as q}from"./index--aP1ir6c.js";import{m as d}from"./md5.min-DazRFQwU.js";import{a as I}from"./axios-Cm0UX6qg.js";import{N as U}from"./Notice-BXLwIgDl.js";const c=l=>(k("data-v-107ca1bd"),l=l(),q(),l),z={class:"pass"},B={class:"item"},j=c(()=>e("div",null,"旧密码",-1)),E={class:"item"},M=c(()=>e("div",null,"新密码",-1)),P={class:"item"},T=c(()=>e("div",null,"确认新密码",-1)),A=c(()=>e("div",{class:"btn-group"},[e("button",{type:"submit"},"提交"),e("button",{type:"reset"},"取消")],-1)),D={__name:"SetupPass",props:{user:{type:Object,default:()=>({})}},setup(l){const m=l;let a=p(""),t=p(""),u=p(""),v=p(!1),g=p("");const x=()=>{if(m.user.upass!==d.md5(a.value)){console.log("pass not match"),n("旧密码错误");return}if(t.value!==u.value){console.log("new pass not consistent"),n("新密码不一致");return}if(t.value==a.value){console.log("pass not change"),n("新密码与旧密码相同");return}console.log(d.md5(t.value)),y({usn:m.user.usn,ukey:"upass",uvalue:d.md5(t.value)}),m.user.upass=d.md5(t.value)},y=r=>{I.post("/user/modify",r).then(s=>{console.log("then",s),n("修改成功")}).catch(s=>{console.log("err",s),n("修改失败")})},n=r=>{v.value=!0,g.value=r,setTimeout(()=>{v.value=!1},3e3)};return(r,s)=>(V(),w("div",z,[e("form",{onSubmit:S(x,["prevent"])},[e("div",B,[j,_(e("input",{type:"text",name:"oldupass",maxlength:"16",required:"","onUpdate:modelValue":s[0]||(s[0]=o=>h(a)?a.value=o:a=o),placeholder:"16个字符以内"},null,512),[[f,i(a),void 0,{lazy:!0}]])]),e("div",E,[M,_(e("input",{type:"text",name:"newpass",maxlength:"16",required:"","onUpdate:modelValue":s[1]||(s[1]=o=>h(t)?t.value=o:t=o),placeholder:"16个字符以内"},null,512),[[f,i(t),void 0,{lazy:!0}]])]),e("div",P,[T,_(e("input",{type:"text",name:"temppass",maxlength:"16","onUpdate:modelValue":s[2]||(s[2]=o=>h(u)?u.value=o:u=o),required:"",placeholder:"16个字符以内"},null,512),[[f,i(u),void 0,{lazy:!0}]])]),A],32),N(U,{flag:i(v),tips:i(g)},null,8,["flag","tips"])]))}},G=b(D,[["__scopeId","data-v-107ca1bd"]]);export{G as default};
