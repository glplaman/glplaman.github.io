import{_ as D,r as _,n as N,o as x,g as I,w as m,c as i,F as b,k as e,q as w,v as S,l as O,t as a,u as f,d as U,a as c,p as V,j as B}from"./index-CjcobUH4.js";import{u as F}from"./cart-CMLgvMIJ.js";import{N as M}from"./Notice-41uf2vEt.js";import"./api-CneDOw5Z.js";import"./axios-Cm0UX6qg.js";const l=d=>(V("data-v-1c445ab7"),d=d(),B(),d),j={class:"cart"},E={class:"item leading"},T={class:"leading-title"},z=l(()=>e("span",null,"商品",-1)),G={class:"sort-box"},H={class:"leading-title"},J=l(()=>e("span",null,"单价",-1)),K={class:"sort-box"},P={class:"leading-title"},Q=l(()=>e("span",null,"库存",-1)),R={class:"sort-box"},W=l(()=>e("div",null,"操作",-1)),X={class:"item"},Y=["value"],Z={class:"ellipsis"},ss={class:"btn-group"},ts=["onClick"],es={class:"number"},os=["onClick"],ns={class:"total"},ls={key:1,class:"empty"},is=l(()=>e("span",{class:"iconfont icon-cart-full-fill"},null,-1)),as=l(()=>e("div",null,"购物车为空",-1)),cs=[is,as],ds={__name:"Cart",setup(d){const r=F();let u=_(!1),k=_("");const n=N({selectedAll:!1,selectedLists:[],lists:[]});let C=_(0);const y=o=>{o.quantity<o.stock&&o.quantity++},A=o=>{o.quantity>1&&o.quantity--},h=o=>{n.lists.sort((s,t)=>s[o]-t[o])},g=o=>{n.lists.sort((s,t)=>t[o]-s[o])},L=o=>{n.lists.sort((s,t)=>s[o].localeCompare(t[o]))},$=o=>{n.lists.sort((s,t)=>t[o].localeCompare(s[o]))};x(()=>{r.cart.length||(r.fetchCart(),q("数据加载完毕")),n.lists=I(()=>r.cart)});let p=!0;m(()=>n.selectedAll,o=>{o?n.selectedLists=[...n.lists]:p&&(n.selectedLists=[])}),m(()=>n.selectedLists,o=>{o.length==n.lists.length&&n.lists.length?(n.selectedAll=!0,p=!0):(n.selectedAll=!1,p=!1),C.value=n.selectedLists.reduce((s,t)=>s+t.quantity*t.price,0).toFixed(2)},{deep:!0,immediate:!0});const q=o=>{u.value=!0,k.value=o,setTimeout(()=>{u.value=!1},3e3)};return(o,s)=>(c(),i("div",j,[n.lists.length?(c(),i(b,{key:0},[e("div",E,[w(e("input",{type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=t=>n.selectedAll=t),onChange:s[1]||(s[1]=(...t)=>o.selAll&&o.selAll(...t))},null,544),[[S,n.selectedAll]]),e("div",T,[z,e("div",G,[e("span",{class:"iconfont icon-up icon",onClick:s[2]||(s[2]=t=>L("name"))}),e("span",{class:"iconfont icon-down icon",onClick:s[3]||(s[3]=t=>$("name"))})])]),e("div",H,[J,e("div",K,[e("span",{class:"iconfont icon-up icon",onClick:s[4]||(s[4]=t=>h("price"))}),e("span",{class:"iconfont icon-down icon",onClick:s[5]||(s[5]=t=>g("price"))})])]),e("div",P,[Q,e("div",R,[e("span",{class:"iconfont icon-up icon",onClick:s[6]||(s[6]=t=>h("stock"))}),e("span",{class:"iconfont icon-down icon",onClick:s[7]||(s[7]=t=>g("stock"))})])]),W]),(c(!0),i(b,null,O(n.lists,t=>(c(),i("div",X,[w(e("input",{type:"checkbox",value:t,"onUpdate:modelValue":s[8]||(s[8]=v=>n.selectedLists=v)},null,8,Y),[[S,n.selectedLists]]),e("div",Z,a(t.name),1),e("div",null,a(t.price),1),e("div",null,a(t.stock),1),e("div",ss,[e("button",{onClick:v=>A(t)},"-",8,ts),e("div",es,a(t.quantity),1),e("button",{onClick:v=>y(t)},"+",8,os)])]))),256)),e("div",ns,[e("div",null,"总价: "+a(f(C)),1),e("button",{class:"order-btn",onClick:s[9]||(s[9]=(...t)=>o.setOrder&&o.setOrder(...t))},"立即下单"),e("button",{class:"cart-btn",onClick:s[10]||(s[10]=(...t)=>o.setOrder&&o.setOrder(...t))},"找人代付")])],64)):(c(),i("div",ls,cs)),U(M,{flag:f(u),tips:f(k)},null,8,["flag","tips"])]))}},fs=D(ds,[["__scopeId","data-v-1c445ab7"]]);export{fs as default};
