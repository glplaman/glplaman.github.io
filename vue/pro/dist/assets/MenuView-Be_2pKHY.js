import{u as S}from"./cart-DthTtQw_.js";import{a as C,r as B,k as I,S as j}from"./Switch-IpCz2DUt.js";import{_ as y,o as p,c as m,a as t,r as u,w as $,b as q,d as x,v as V,t as i,e as w,F as T,f as z,u as D,g as f,h as R,i as U,n as F,j as M,k as A,l as E,m as G}from"./index-DwgMRqtp.js";import{T as K}from"./Tabbar-CkdRQU-3.js";/* empty css                                                               */const L={},O={class:"search"},P={class:"clear",ref:"clear-ref"};function H(g,o){return p(),m("div",O,[o[1]||(o[1]=t("span",{class:"iconfont icon-sousuo_o"},null,-1)),o[2]||(o[2]=t("input",{class:"ipt",type:"text",placeholder:"小黄杏美式"},null,-1)),t("div",P,o[0]||(o[0]=[t("span",{class:"iconfont icon-guanbi_o"},null,-1)]),512)])}const J=y(L,[["render",H],["__scopeId","data-v-2c873a0a"]]),Q={class:"cont"},W={class:"header"},X={class:"all"},Y={for:"all"},Z=["value"],tt=["src"],st={class:"info"},et={class:"title"},at={class:"sub-title"},ot={class:"price-new"},nt={class:"price-old"},lt={class:"oper"},it=["onClick"],ct={class:"num"},rt=["onClick"],ut={class:"cart-num f-s-s"},dt={class:"price"},pt={class:"total-price f-s-m f-b"},vt={class:"total-promotion f-s-s"},_t={__name:"Cart",setup(g){const o=u(!1),c=S(),n=u([...c.cart]),r=u(!0),h=u(0),v=u(0);let _=!0;$(n,()=>{n.value.length===c.cart.length?(r.value=!0,_=!0):(r.value=!1,_=!1),h.value=n.value.reduce((a,s)=>a+s.price*s.quantity*(1-s.discount),0),v.value=n.value.reduce((a,s)=>a+s.quantity,0)},{deep:!0,immediate:!0}),$(r,a=>{a?n.value=c.cart:_&&(n.value=[])});const k=()=>{c.clearCart(),n.value=[],r.value=!1},d=()=>{o.value=!1},e=()=>c.cart.reduce((a,s)=>a+s.price*s.discount*s.quantity,0);return q(()=>{console.log("cart loading",c.cart)}),(a,s)=>{const N=M("router-link");return p(),m("div",{class:F(["cart",{"show-cont-all":o.value}]),onClick:w(d,["self"])},[t("div",Q,[t("header",W,[t("div",X,[x(t("input",{type:"checkbox",id:"all","onUpdate:modelValue":s[0]||(s[0]=l=>r.value=l)},null,512),[[V,r.value]]),t("label",Y,"已选择商品（"+i(v.value)+"件）",1)]),t("button",{class:"clear",onClick:w(k,["stop"])},s[3]||(s[3]=[t("span",{class:"iconfont icon-shanchu_o"},null,-1),t("span",null,"清空购物车",-1)]))]),(p(!0),m(T,null,z(D(c).cart,(l,bt)=>(p(),m("div",{class:"item",key:l.id},[x(t("input",{type:"checkbox",name:"",id:"","onUpdate:modelValue":s[1]||(s[1]=b=>n.value=b),value:l},null,8,Z),[[V,n.value]]),t("img",{class:"img",src:`https://glpla.github.io/utils${l.img}`,alt:""},null,8,tt),t("div",st,[t("h4",et,i(l.name),1),t("div",at,i(l.desc),1),t("div",null,[t("span",ot,"¥"+i(l.price),1),t("span",nt,"¥"+i(l.priceOrignal),1)])]),t("div",lt,[t("button",{class:"btn dec",onClick:b=>l.quantity--},"-",8,it),t("span",ct,i(l.quantity),1),t("button",{class:"btn inc",onClick:b=>l.quantity++},"+",8,rt)])]))),128))]),t("footer",null,[t("button",{class:"btn cart-left",onClick:s[2]||(s[2]=w(l=>o.value=!o.value,["stop"]))},[s[4]||(s[4]=t("span",{class:"iconfont icon-icon_ruixingkafei"},null,-1)),t("span",ut,i(v.value),1)]),t("div",dt,[t("div",null,[s[5]||(s[5]=t("span",null,"预计到手 ",-1)),t("span",pt,"¥"+i(h.value.toFixed(2)),1)]),t("div",vt,[s[6]||(s[6]=t("span",null,"已享受更多优惠，共减免 ",-1)),t("span",null,"¥"+i(e().toFixed(2)),1)])]),f(N,{class:"btn pay-btn f-s-b",to:"/order"},{default:R(()=>s[7]||(s[7]=[U("去结算")])),_:1})])],2)}}},ft=y(_t,[["__scopeId","data-v-5022364a"]]),mt={class:"menu-view p-b-10"},ht={class:"header"},kt={__name:"MenuView",setup(g){const o=S(),c=G("axios"),n=u({}),r=u({}),h=u({}),v=u({}),_=[{ind:0,title:"经典菜单",path:"/menu",keyword:"classic"},{ind:1,title:"会员卡",path:"/menu/vip",keyword:"member"},{ind:2,title:"年度封神榜",path:"/menu/rank",keyword:"rank"},{ind:3,title:"我的常点",path:"/menu/favorite",keyword:"favor"}],k=u([{title:"自提"},{title:"外送"}]);return q(()=>{c.get(`/map-api/ws/location/v1/ip?ip=&key=${C}`).then(d=>{r.value=d.data.result.location,c.get(`/map-api/ws/place/v1/search?boundary=nearby(${r.value.lat},${r.value.lng},${B})&keyword=${I}&page_size=10&page_index=1&key=${C}`).then(e=>{n.value={title:e.data.data[0].title.replace(/瑞幸咖啡\(/,"").replace(/\)/,""),distance:e.data.data[0]._distance.toFixed(0)},h.value=e.data.data.map(a=>({...a,open:"08:30 - 21:30"})),v.value=e.data.data.map(a=>({styleId:"marker",position:a.location,content:a.title}))})})}),(d,e)=>{const a=M("RouterView");return p(),m("div",mt,[t("div",ht,[f(j,{switchs:k.value},null,8,["switchs"]),f(J,{class:"search",onClick:e[0]||(e[0]=s=>d.$router.push("/search"))})]),t("div",{class:"loc-box",onClick:e[1]||(e[1]=s=>d.$router.push("/location"))},[e[2]||(e[2]=t("span",{class:"iconfont icon-didiandingwei_o"},null,-1)),t("span",null,i(n.value.title)+" | "+i(n.value.distance)+"m",1),e[3]||(e[3]=t("button",null,[t("span",{class:"iconfont icon-jiantou_liebiaoxiangyou_o"})],-1))]),f(K,{tabs:_}),f(a,{class:"p-1"}),D(o).cart.length?(p(),A(ft,{key:0,class:F(["w cart",{pos:d.$route.meta.showNav}])},null,8,["class"])):E("",!0)])}}},xt=y(kt,[["__scopeId","data-v-8dd3cb78"]]);export{xt as default};
