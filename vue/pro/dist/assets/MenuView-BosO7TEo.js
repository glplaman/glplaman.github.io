import{u as F}from"./cart-DbHe3dJV.js";import{a as V,r as I,k as j}from"./tbl-Dt5epI9H.js";import{D as T}from"./Delivery-KI0Wsd5T.js";import{_ as w,o as d,c as _,a as t,w as g,v as U,r as u,b as D,d as M,e as z,f as q,t as c,g as b,F as A,h as N,u as B,i as $,j as G,n as C,k as E,l as S,m as K,p as L,q as O}from"./index-DcAuZYyn.js";import P from"./Goods-Zq6SUTFx.js";import R from"./Vip-CzCzkTNw.js";import H from"./Rank-Cfg8EHiI.js";import J from"./Favorite-BDPtaKti.js";import"./goods-AYS97Y8g.js";const Q={},W={class:"search"},X={class:"clear",ref:"clear-ref"};function Y(m,o){return d(),_("div",W,[o[2]||(o[2]=t("span",{class:"iconfont icon-sousuo_o"},null,-1)),g(t("input",{class:"ipt",type:"text","onUpdate:modelValue":o[0]||(o[0]=i=>m.search=i),placeholder:"小黄杏美式"},null,512),[[U,m.search,void 0,{trim:!0}]]),t("div",X,o[1]||(o[1]=[t("span",{class:"iconfont icon-guanbi_o"},null,-1)]),512)])}const Z=w(Q,[["render",Y],["__scopeId","data-v-4696a3d0"]]),tt={class:"cont"},st={class:"header"},et={class:"all"},at={for:"all"},ot=["value"],nt=["src"],lt={class:"info"},it={class:"title"},ct={class:"sub-title"},rt={class:"price-new"},ut={class:"price-old"},dt={class:"oper"},pt=["onClick"],vt={class:"num"},_t=["onClick"],ft={class:"cart-num f-s-s"},mt={class:"price"},ht={class:"total-price f-s-m f-b"},kt={class:"total-promotion f-s-s"},yt={__name:"Cart",setup(m){const o=u(!1),i=F(),n=u([...i.cart]),r=u(!0),h=u(0),f=u(0);let p=!0;D(n,()=>{n.value.length===i.cart.length?(r.value=!0,p=!0):(r.value=!1,p=!1),h.value=n.value.reduce((e,s)=>e+s.price*s.quantity*(1-s.discount),0),f.value=n.value.reduce((e,s)=>e+s.quantity,0)},{deep:!0,immediate:!0}),D(r,e=>{e?n.value=i.cart:p&&(n.value=[])});const k=()=>{i.clearCart(),n.value=[],r.value=!1},v=()=>{o.value=!1},a=()=>i.cart.reduce((e,s)=>e+s.price*s.discount*s.quantity,0);return M(()=>{console.log("cart loading",i.cart)}),(e,s)=>{const x=z("router-link");return d(),_("div",{class:C(["cart",{"show-cont-all":o.value}]),onClick:b(v,["self"])},[t("div",tt,[t("header",st,[t("div",et,[g(t("input",{type:"checkbox",id:"all","onUpdate:modelValue":s[0]||(s[0]=l=>r.value=l)},null,512),[[q,r.value]]),t("label",at,"已选择商品（"+c(f.value)+"件）",1)]),t("button",{class:"clear",onClick:b(k,["stop"])},s[3]||(s[3]=[t("span",{class:"iconfont icon-shanchu_o"},null,-1),t("span",null,"清空购物车",-1)]))]),(d(!0),_(A,null,N(B(i).cart,(l,Dt)=>(d(),_("div",{class:"item",key:l.id},[g(t("input",{type:"checkbox",name:"",id:"","onUpdate:modelValue":s[1]||(s[1]=y=>n.value=y),value:l},null,8,ot),[[q,n.value]]),t("img",{class:"img",src:`https://glpla.github.io/utils${l.img}`,alt:""},null,8,nt),t("div",lt,[t("h4",it,c(l.name),1),t("div",ct,c(l.desc),1),t("div",null,[t("span",rt,"¥"+c(l.price),1),t("span",ut,"¥"+c(l.priceOrignal),1)])]),t("div",dt,[t("button",{class:"btn dec",onClick:y=>l.quantity--},"-",8,pt),t("span",vt,c(l.quantity),1),t("button",{class:"btn inc",onClick:y=>l.quantity++},"+",8,_t)])]))),128))]),t("footer",null,[t("button",{class:"btn cart-left",onClick:s[2]||(s[2]=b(l=>o.value=!o.value,["stop"]))},[s[4]||(s[4]=t("span",{class:"iconfont icon-icon_ruixingkafei"},null,-1)),t("span",ft,c(f.value),1)]),t("div",mt,[t("div",null,[s[5]||(s[5]=t("span",null,"预计到手 ",-1)),t("span",ht,"¥"+c(h.value.toFixed(2)),1)]),t("div",kt,[s[6]||(s[6]=t("span",null,"已享受更多优惠，共减免 ",-1)),t("span",null,"¥"+c(a().toFixed(2)),1)])]),$(x,{class:"btn pay-btn f-s-b",to:"/order"},{default:G(()=>s[7]||(s[7]=[E("去结算")])),_:1})])],2)}}},bt=w(yt,[["__scopeId","data-v-5022364a"]]),gt={class:"menu-view p-b-10"},$t={class:"header"},Ct={class:"tab-box"},wt=["onClick"],xt={class:"tab-cont"},Vt={__name:"MenuView",setup(m){const o=F(),i=O("axios"),n=u({}),r=u({}),h=u({}),f=u({}),p=u("经典菜单"),k={经典菜单:P,会员卡:R,年度封神榜:H,我的常点:J};return M(()=>{i.get(`/map-api/ws/location/v1/ip?ip=&key=${V}`).then(v=>{r.value=v.data.result.location,i.get(`/map-api/ws/place/v1/search?boundary=nearby(${r.value.lat},${r.value.lng},${I})&keyword=${j}&page_size=10&page_index=1&key=${V}`).then(a=>{n.value={title:a.data.data[0].title.replace(/瑞幸咖啡\(/,"").replace(/\)/,""),distance:a.data.data[0]._distance.toFixed(0)},h.value=a.data.data.map(e=>({...e,open:"08:30 - 21:30"})),f.value=a.data.data.map(e=>({styleId:"marker",position:e.location,content:e.title}))})})}),(v,a)=>(d(),_("div",gt,[t("div",$t,[$(T),$(Z,{class:"search",onClick:a[0]||(a[0]=e=>v.$router.push("/search"))})]),t("div",{class:"loc-box",onClick:a[1]||(a[1]=e=>v.$router.push("/location"))},[a[2]||(a[2]=t("span",{class:"iconfont icon-didiandingwei_o"},null,-1)),t("span",null,c(n.value.title)+" | "+c(n.value.distance)+"m",1),a[3]||(a[3]=t("button",null,[t("span",{class:"iconfont icon-jiantou_liebiaoxiangyou_o"})],-1))]),t("div",Ct,[(d(),_(A,null,N(k,(e,s)=>t("button",{key:s,class:C(["tab-item f-s-m",{active:p.value===s}]),onClick:x=>p.value=s},c(s),11,wt)),64))]),t("div",xt,[(d(),S(K(k[p.value])))]),B(o).cart.length?(d(),S(bt,{key:0,class:C(["w cart",{pos:v.$route.meta.showNav}])},null,8,["class"])):L("",!0)]))}},Tt=w(Vt,[["__scopeId","data-v-0018363e"]]);export{Tt as default};
