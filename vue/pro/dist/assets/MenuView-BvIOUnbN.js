import{u as F}from"./cart-5ED4J8uW.js";import{a as x,r as T,k as j,S as z}from"./Switch-hVBZNyXc.js";import{_ as $,o as d,c as v,a as t,r as i,w as S,b as A,d as G,e as V,v as q,t as l,f as g,F as B,g as M,u as N,h as k,i as U,j as E,n as w,k as D,l as K,m as L,p as O,T as P}from"./index-D1Vg663f.js";import R from"./Goods-CrZ6MWLN.js";import H from"./Vip-DB8WN1uN.js";import J from"./Rank-Bs-Z6784.js";import Q from"./Favorite-ZydKoP_Z.js";import"./goods-CpWc4cTT.js";const W={},X={class:"search"},Y={class:"clear",ref:"clear-ref"};function Z(C,o){return d(),v("div",X,[o[1]||(o[1]=t("span",{class:"iconfont icon-sousuo_o"},null,-1)),o[2]||(o[2]=t("input",{class:"ipt",type:"text",placeholder:"小黄杏美式"},null,-1)),t("div",Y,o[0]||(o[0]=[t("span",{class:"iconfont icon-guanbi_o"},null,-1)]),512)])}const tt=$(W,[["render",Z],["__scopeId","data-v-2c873a0a"]]),st={class:"cont"},et={class:"header"},at={class:"all"},ot={for:"all"},nt=["value"],lt=["src"],it={class:"info"},ct={class:"title"},rt={class:"sub-title"},ut={class:"price-new"},dt={class:"price-old"},pt={class:"oper"},vt=["onClick"],_t={class:"num"},ft=["onClick"],mt={class:"cart-num f-s-s"},kt={class:"price"},ht={class:"total-price f-s-m f-b"},bt={class:"total-promotion f-s-s"},yt={__name:"Cart",setup(C){const o=i(!1),c=F(),n=i([...c.cart]),r=i(!0),f=i(0),_=i(0);let p=!0;S(n,()=>{n.value.length===c.cart.length?(r.value=!0,p=!0):(r.value=!1,p=!1),f.value=n.value.reduce((a,s)=>a+s.price*s.quantity*(1-s.discount),0),_.value=n.value.reduce((a,s)=>a+s.quantity,0)},{deep:!0,immediate:!0}),S(r,a=>{a?n.value=c.cart:p&&(n.value=[])});const m=()=>{c.clearCart(),n.value=[],r.value=!1},h=()=>{o.value=!1},b=()=>c.cart.reduce((a,s)=>a+s.price*s.discount*s.quantity,0);return A(()=>{console.log("cart loading",c.cart)}),(a,s)=>{const u=G("router-link");return d(),v("div",{class:w(["cart",{"show-cont-all":o.value}]),onClick:g(h,["self"])},[t("div",st,[t("header",et,[t("div",at,[V(t("input",{type:"checkbox",id:"all","onUpdate:modelValue":s[0]||(s[0]=e=>r.value=e)},null,512),[[q,r.value]]),t("label",ot,"已选择商品（"+l(_.value)+"件）",1)]),t("button",{class:"clear",onClick:g(m,["stop"])},s[3]||(s[3]=[t("span",{class:"iconfont icon-shanchu_o"},null,-1),t("span",null,"清空购物车",-1)]))]),(d(!0),v(B,null,M(N(c).cart,(e,I)=>(d(),v("div",{class:"item",key:e.id},[V(t("input",{type:"checkbox",name:"",id:"","onUpdate:modelValue":s[1]||(s[1]=y=>n.value=y),value:e},null,8,nt),[[q,n.value]]),t("img",{class:"img",src:`https://glpla.github.io/utils${e.img}`,alt:""},null,8,lt),t("div",it,[t("h4",ct,l(e.name),1),t("div",rt,l(e.desc),1),t("div",null,[t("span",ut,"¥"+l(e.price),1),t("span",dt,"¥"+l(e.priceOrignal),1)])]),t("div",pt,[t("button",{class:"btn dec",onClick:y=>e.quantity--},"-",8,vt),t("span",_t,l(e.quantity),1),t("button",{class:"btn inc",onClick:y=>e.quantity++},"+",8,ft)])]))),128))]),t("footer",null,[t("button",{class:"btn cart-left",onClick:s[2]||(s[2]=g(e=>o.value=!o.value,["stop"]))},[s[4]||(s[4]=t("span",{class:"iconfont icon-icon_ruixingkafei"},null,-1)),t("span",mt,l(_.value),1)]),t("div",kt,[t("div",null,[s[5]||(s[5]=t("span",null,"预计到手 ",-1)),t("span",ht,"¥"+l(f.value.toFixed(2)),1)]),t("div",bt,[s[6]||(s[6]=t("span",null,"已享受更多优惠，共减免 ",-1)),t("span",null,"¥"+l(b().toFixed(2)),1)])]),k(u,{class:"btn pay-btn f-s-b",to:"/order"},{default:U(()=>s[7]||(s[7]=[E("去结算")])),_:1})])],2)}}},gt=$(yt,[["__scopeId","data-v-5022364a"]]),wt={class:"menu-view p-b-10"},$t={class:"header"},Ct={class:"tab-box"},xt=["onClick"],St={class:"tab-cont"},Vt={__name:"MenuView",setup(C){const o=F(),c=O("axios"),n=i({}),r=i({}),f=i({}),_=i({}),p=i("经典菜单"),m={经典菜单:R,会员卡:H,年度封神榜:J,我的常点:Q},h=[{title:"经典菜单",keyword:"classic"},{title:"会员卡",keyword:"member"},{title:"年度封神榜",keyword:"rank"},{title:"我的常点",keyword:"favor"}],b=i([{title:"自提"},{title:"外送"}]);return A(()=>{c.get(`/map-api/ws/location/v1/ip?ip=&key=${x}`).then(a=>{r.value=a.data.result.location,c.get(`/map-api/ws/place/v1/search?boundary=nearby(${r.value.lat},${r.value.lng},${T})&keyword=${j}&page_size=10&page_index=1&key=${x}`).then(s=>{n.value={title:s.data.data[0].title.replace(/瑞幸咖啡\(/,"").replace(/\)/,""),distance:s.data.data[0]._distance.toFixed(0)},f.value=s.data.data.map(u=>({...u,open:"08:30 - 21:30"})),_.value=s.data.data.map(u=>({styleId:"marker",position:u.location,content:u.title}))})})}),(a,s)=>(d(),v("div",wt,[t("div",$t,[k(z,{switchs:b.value},null,8,["switchs"]),k(tt,{class:"search",onClick:s[0]||(s[0]=u=>a.$router.push("/search"))})]),t("div",{class:"loc-box",onClick:s[1]||(s[1]=u=>a.$router.push("/location"))},[s[2]||(s[2]=t("span",{class:"iconfont icon-didiandingwei_o"},null,-1)),t("span",null,l(n.value.title)+" | "+l(n.value.distance)+"m",1),s[3]||(s[3]=t("button",null,[t("span",{class:"iconfont icon-jiantou_liebiaoxiangyou_o"})],-1))]),t("div",Ct,[(d(),v(B,null,M(m,(u,e)=>t("button",{key:e,class:w(["tab-item f-s-m",{active:p.value===e}]),onClick:I=>p.value=e},l(e),11,xt)),64))]),k(P,{tabs:h}),t("div",St,[(d(),D(K(m[p.value])))]),N(o).cart.length?(d(),D(gt,{key:0,class:w(["w cart",{pos:a.$route.meta.showNav}])},null,8,["class"])):L("",!0)]))}},Tt=$(Vt,[["__scopeId","data-v-7276422c"]]);export{Tt as default};
