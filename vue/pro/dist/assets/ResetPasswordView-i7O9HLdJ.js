import{r as n,e as f,c as d,a as s,g as y,w as c,a8 as p,t as g,q as _,a4 as b,o as v,k,a1 as q}from"./index-BerH3bZh.js";const P={class:"reset-password-view"},V={class:"reset-password-view"},x={class:"item"},U={class:"item"},B={key:0,class:"message"},D={__name:"ResetPasswordView",setup(M){const r=b(),m=k(),a=n(""),l=n(""),o=n(""),w=async()=>{if(a.value!==l.value){o.value="新密码和确认密码不一致";return}const u=r.query.access_token,e=r.query.email;if(!u||!e){o.value="无效的重置链接";return}try{const{data:t,error:i}=await q.auth.updateUser({email:e,password:a.value,data:{updated:!0}});i?(console.error("Error updating password:",i),o.value="重置密码失败，请重试。"):(console.log("Password updated successfully:",t),o.value="密码重置成功，请重新登录。",m.replace("/login-email"))}catch(t){console.error("Unexpected error:",t),o.value="发生意外错误，请稍后再试。"}};return f(()=>{console.log(r.query)}),(u,e)=>(v(),d("div",P,[s("div",V,[e[5]||(e[5]=s("h3",{class:"title f-b"},"重置密码",-1)),s("form",{onSubmit:y(w,["prevent"])},[s("div",x,[c(s("input",{type:"password","onUpdate:modelValue":e[0]||(e[0]=t=>a.value=t),required:"",placeholder:"新密码"},null,512),[[p,a.value]]),e[2]||(e[2]=s("span",{class:"iconfont icon-suoding_o"},null,-1))]),s("div",U,[c(s("input",{type:"password","onUpdate:modelValue":e[1]||(e[1]=t=>l.value=t),required:"",placeholder:"确认新密码"},null,512),[[p,l.value]]),e[3]||(e[3]=s("span",{class:"iconfont icon-suoding_o"},null,-1))]),e[4]||(e[4]=s("div",{class:"item"},[s("button",{class:"submit-btn",type:"submit"},"重置密码")],-1))],32),o.value?(v(),d("p",B,g(o.value),1)):_("",!0)])]))}};export{D as default};
