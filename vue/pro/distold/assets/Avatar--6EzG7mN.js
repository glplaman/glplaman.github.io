import{_ as h,r as l,a as v,c as k,d as s,f as y,e as p,A as d}from"./index-CP9-9HUk.js";import{N as x}from"./Notice-CXWklV3Q.js";const N={class:"avatar"},I={class:"avatar-box"},U=["src"],b={__name:"Avatar",props:{user:{type:Object,default:()=>({})}},setup(c){let o=l(!1),r=l("");const n=c;let i=l(null);const m=()=>{i.value.click()},f=e=>{console.log(e.target.files[0]);let t=e.target.files[0];g(t)},g=e=>{let t=new FormData;t.append("image",e),d.post("/api/uploadimg",t,{headers:{"Content-Type":"multipart/form-data"}}).then(a=>{console.log("then",a),_({usn:n.user.usn,ukey:"imgUrl",uvalue:a.data.data.url}),n.user.imgUrl=a.data.data.url}).catch(a=>{console.log("err",a)})},_=e=>{d.post("/user/modify",e).then(t=>{console.log("then",t),u("修改成功")}).catch(t=>{console.log("err",t),u("修改失败")})},u=e=>{o.value=!0,r.value=e,setTimeout(()=>{o.value=!1},3e3)};return(e,t)=>(v(),k("div",N,[s("div",I,[s("img",{src:c.user.imgUrl,alt:""},null,8,U),s("input",{type:"file",name:"image",ref_key:"ipt",ref:i,accept:"image/*",hidden:"",onChange:f},null,544),s("div",{class:"avatar-btn",onClick:m},"上传头像")]),y(x,{flag:p(o),tips:p(r)},null,8,["flag","tips"])]))}},B=h(b,[["__scopeId","data-v-fe9399c3"]]);export{B as default};
