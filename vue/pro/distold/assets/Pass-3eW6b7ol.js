import{_ as b,r as i,a as w,c as N,d as e,x as _,y as h,e as p,i as f,h as S,f as V,P as r,A as k,p as I,k as U}from"./index-DTrq-Qla.js";import{N as q}from"./Notice-BfpwmsEL.js";const c=l=>(I("data-v-ce0d85b0"),l=l(),U(),l),z={class:"pass"},B={class:"item"},P=c(()=>e("div",null,"旧密码",-1)),E={class:"item"},M=c(()=>e("div",null,"新密码",-1)),T={class:"item"},j=c(()=>e("div",null,"确认新密码",-1)),A=c(()=>e("div",{class:"btn-group"},[e("button",{type:"submit"},"提交"),e("button",{type:"reset"},"取消")],-1)),D={__name:"Pass",props:{user:{type:Object,default:()=>({})}},setup(l){const m=l;let a=i(""),t=i(""),u=i(""),v=i(!1),g=i("");const x=()=>{if(m.user.upass!==r.md5(a.value)){console.log("pass not match"),n("旧密码错误");return}if(t.value!==u.value){console.log("new pass not consistent"),n("新密码不一致");return}if(t.value==a.value){console.log("pass not change"),n("新密码与旧密码相同");return}console.log(r.md5(t.value)),y({usn:m.user.usn,ukey:"upass",uvalue:r.md5(t.value)}),m.user.upass=r.md5(t.value)},y=d=>{k.post("/user/modify",d).then(s=>{console.log("then",s),n("修改成功")}).catch(s=>{console.log("err",s),n("修改失败")})},n=d=>{v.value=!0,g.value=d,setTimeout(()=>{v.value=!1},3e3)};return(d,s)=>(w(),N("div",z,[e("form",{onSubmit:S(x,["prevent"])},[e("div",B,[P,_(e("input",{type:"text",name:"oldupass",maxlength:"16",required:"","onUpdate:modelValue":s[0]||(s[0]=o=>f(a)?a.value=o:a=o),placeholder:"16个字符以内"},null,512),[[h,p(a),void 0,{lazy:!0}]])]),e("div",E,[M,_(e("input",{type:"text",name:"newpass",maxlength:"16",required:"","onUpdate:modelValue":s[1]||(s[1]=o=>f(t)?t.value=o:t=o),placeholder:"16个字符以内"},null,512),[[h,p(t),void 0,{lazy:!0}]])]),e("div",T,[j,_(e("input",{type:"text",name:"temppass",maxlength:"16","onUpdate:modelValue":s[2]||(s[2]=o=>f(u)?u.value=o:u=o),required:"",placeholder:"16个字符以内"},null,512),[[h,p(u),void 0,{lazy:!0}]])]),A],32),V(q,{flag:p(v),tips:p(g)},null,8,["flag","tips"])]))}},C=b(D,[["__scopeId","data-v-ce0d85b0"]]);export{C as default};
