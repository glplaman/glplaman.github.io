import{_ as z,f as r,g as A,w as E,o as _,c as p,b as t,d as o,F as C,e as w,i as n,a as S,A as V,l as H,B as R,j as $,N as L,C as G,t as k,n as B,y as J,D as K,m as O,q as P,s as Q}from"./index-4NOsK6IO.js";import{u as W,w as X}from"./xlsx-ChWuxSKv.js";const a=f=>(P("data-v-8a59561f"),f=f(),Q(),f),Y={class:"user"},Z=a(()=>t("span",{class:"iconfont icon-customer-fill"},null,-1)),tt=a(()=>t("span",{class:"iconfont icon-change"},null,-1)),st=a(()=>t("span",{class:"iconfont icon-excel-full"},null,-1)),et=a(()=>t("tr",{class:"tbl-header"},[t("th",null,[o("学号"),t("br"),t("span",null,"usn")]),t("th",null,[o("昵称"),t("br"),t("span",null,"uname")]),t("th",null,[o("头像"),t("br"),t("span",null,"uavatar")]),t("th",null,[o("积分"),t("br"),t("span",null,"ucredit")]),t("th",null,[o("操作"),t("br"),t("span",null,"uoper")])],-1)),lt={hidden:""},at=["src"],nt={class:"btn-group"},ot=["onClick"],ut=a(()=>t("span",{class:"iconfont icon-edit"},null,-1)),it=[ut],ct=["onClick"],rt=a(()=>t("span",{class:"iconfont icon-delete-fill"},null,-1)),dt=[rt],vt={key:0,class:"add-user-wrap"},_t=a(()=>t("h3",{class:"dia-title"},"add user",-1)),pt={class:"dia-cont"},ht={class:"add-item"},bt=a(()=>t("span",null,"学号",-1)),ft={class:"add-item"},mt=a(()=>t("span",null,"昵称",-1)),gt={class:"add-item"},kt=a(()=>t("span",null,"头像",-1)),xt={class:"img-box"},yt=["value"],Ct={class:"add-item"},wt=a(()=>t("span",null,"积分",-1)),St=["onClick"],Ut=a(()=>t("button",{class:"add",type:"submit"},[o("提交 "),t("span",{class:"iconfont icon-tick"})],-1)),It=a(()=>t("span",{class:"iconfont icon-close"},null,-1)),Nt={__name:"User",setup(f){let m=r(!1),U=r(""),h=r(null),x=r(null),v=r([]),g=r(!1),d=r(-1),e=r({usn:"",uname:"",uavatar:"",ucredit:0});const I=s=>{g.value=!0,s&&(e.value={...s})},D=s=>{console.log(s),v.value.splice(s,1)},F=()=>{g.value=!1,m.value=!1,N()},M=()=>{if(!e.value.usn){console.log("user sn is null"),u("学号不能为空");return}if(!e.value.uname){console.log("user name is null"),u("用户昵称不能为空");return}if(!e.value.uavatar){console.log("user avatar is null"),u("用户头像不能为空");return}if(!e.value.ucredit){console.log("user credit is null"),u("用户积分不能为空");return}g.value=!1,v.value.unshift(e.value),u("添加用户成功"),N()},T=s=>{console.log(s),e.value.ucredit=s+1},q=()=>{if(x.value){let s=W.table_to_book(x.value);X(s,"user.xlsx"),u("导出成功")}else console.log("tbl is null"),u("导出失败")},y=()=>{G.get("https://glpla.github.io/utils/data/data2024/rank202401.json").then(s=>{v.value=[...v.value,...s.data.cont],u("数据加载完毕")})},j=()=>{v.value=[],y()};A(()=>{y(),h.value.onscroll=s=>{h.value.scrollTop/(h.value.scrollHeight-h.value.offsetHeight)>=.8&&y()}});const N=()=>{e.value={usn:"",uname:"",uavatar:"",ucredit:0},d.value=-1};E(d,(s,i)=>{e.value.uavatar="/avatar/avatar"+s+".png"},{immediate:!0});const u=s=>{m.value=!0,U.value=s,setTimeout(()=>{m.value=!1},3e3)};return(s,i)=>(_(),p("div",Y,[t("div",{class:"btns-box"},[t("button",{class:"btn add-user-btn",onClick:I},[o("添加 "),Z]),t("button",{class:"btn add-user-btn btn1",onClick:j},[o("刷新 "),tt]),t("button",{class:"btn add-user-btn btn2",onClick:q},[o("导出 "),st])]),t("div",{class:"tbl-box",ref_key:"tblBox",ref:h},[t("table",{ref_key:"tbl",ref:x},[et,(_(!0),p(C,null,w(n(v),(l,c)=>(_(),p("tr",{key:l.id},[t("td",null,k(l.usn),1),t("td",null,k(l.uname),1),t("td",null,[t("span",lt,k(l.uavatar),1),t("img",{class:"img-avatar",src:"https://glpla.github.io/utils"+l.uavatar,alt:"user avatar"},null,8,at)]),t("td",null,k(l.ucredit),1),t("td",nt,[t("button",{class:"btn edit-btn",onClick:b=>I(l)},it,8,ot),t("button",{class:"btn del-btn",onClick:b=>D(c)},dt,8,ct)])]))),128))],512)],512),n(g)?(_(),p("div",vt,[t("form",{onSubmit:H(M,["prevent"])},[_t,t("div",pt,[t("div",ht,[bt,S(t("input",{type:"text",placeholder:"your sn",name:"usn","onUpdate:modelValue":i[0]||(i[0]=l=>n(e).usn=l),required:""},null,512),[[V,n(e).usn,void 0,{trim:!0}]])]),t("div",ft,[mt,S(t("input",{type:"text",placeholder:"your name",name:"uname","onUpdate:modelValue":i[1]||(i[1]=l=>n(e).uname=l),required:""},null,512),[[V,n(e).uname,void 0,{trim:!0}]])]),t("div",gt,[kt,t("div",xt,[(_(),p(C,null,w(10,(l,c)=>t("label",{class:B(["avatar-img",{active:n(d)==c}]),style:J({backgroundImage:"url(https://glpla.github.io/utils/avatar/avatar"+c+".png)"})},[S(t("input",{type:"radio",name:"uavatar",value:c,"onUpdate:modelValue":i[2]||(i[2]=b=>O(d)?d.value=b:d=b),hidden:""},null,8,yt),[[K,n(d)]])],6)),64))])]),t("div",Ct,[wt,t("div",null,[(_(),p(C,null,w(10,(l,c)=>t("span",{class:B(["iconfont icon-favorites credit-icon",{active:c<n(e).ucredit}]),key:l,onClick:b=>T(c)},null,10,St)),64))])]),t("div",{class:"btn-group"},[Ut,t("button",{class:"cancle",type:"button",onClick:F},[o("取消 "),It])])])],32)])):R("",!0),$(L,{flag:n(m),tips:n(U)},null,8,["flag","tips"])]))}},Dt=z(Nt,[["__scopeId","data-v-8a59561f"]]);export{Dt as default};
