import{_ as A,G as L,r as S,o as $,D as q,v as C,c as d,F as k,d as e,x as b,H as h,m as D,t as c,e as I,a,p as O,k as U}from"./index-CLJThBxz.js";import{u as x}from"./cart-Cci83ke8.js";const l=r=>(O("data-v-6dbef3bd"),r=r(),U(),r),B={class:"cart"},F={class:"item leading"},V={class:"leading-title"},M=l(()=>e("span",null,"商品",-1)),E={class:"sort-box"},G={class:"leading-title"},H=l(()=>e("span",null,"单价",-1)),N={class:"sort-box"},j={class:"leading-title"},z=l(()=>e("span",null,"库存",-1)),J={class:"sort-box"},K=l(()=>e("div",null,"操作",-1)),P={class:"item"},Q=["value"],R={class:"ellipsis"},T={class:"btn-group"},W=["onClick"],X={class:"number"},Y=["onClick"],Z={class:"total"},ss={key:1,class:"empty"},ts=l(()=>e("span",{class:"iconfont icon-cart-full-fill"},null,-1)),es=l(()=>e("div",null,"购物车为空",-1)),os=[ts,es],ns={__name:"Cart",setup(r){const u=x(),n=L({selectedAll:!1,selectedLists:[],lists:[]});let v=S(0);const g=o=>{o.quantity<o.stock&&o.quantity++},m=o=>{o.quantity>1&&o.quantity--},_=o=>{n.lists.sort((s,t)=>s[o]-t[o])},f=o=>{n.lists.sort((s,t)=>t[o]-s[o])},w=o=>{n.lists.sort((s,t)=>s[o].localeCompare(t[o]))},y=o=>{n.lists.sort((s,t)=>t[o].localeCompare(s[o]))};$(()=>{u.cart.length||u.fetchCart(),n.lists=q(()=>u.cart)});let p=!0;return C(()=>n.selectedAll,o=>{o?n.selectedLists=[...n.lists]:p&&(n.selectedLists=[])}),C(()=>n.selectedLists,o=>{o.length==n.lists.length&&n.lists.length?(n.selectedAll=!0,p=!0):(n.selectedAll=!1,p=!1),v.value=n.selectedLists.reduce((s,t)=>s+t.quantity*t.price,0).toFixed(2)},{deep:!0,immediate:!0}),(o,s)=>(a(),d("div",B,[n.lists.length?(a(),d(k,{key:0},[e("div",F,[b(e("input",{type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=t=>n.selectedAll=t),onChange:s[1]||(s[1]=(...t)=>o.selAll&&o.selAll(...t))},null,544),[[h,n.selectedAll]]),e("div",V,[M,e("div",E,[e("span",{class:"iconfont icon-up icon",onClick:s[2]||(s[2]=t=>w("name"))}),e("span",{class:"iconfont icon-down icon",onClick:s[3]||(s[3]=t=>y("name"))})])]),e("div",G,[H,e("div",N,[e("span",{class:"iconfont icon-up icon",onClick:s[4]||(s[4]=t=>_("price"))}),e("span",{class:"iconfont icon-down icon",onClick:s[5]||(s[5]=t=>f("price"))})])]),e("div",j,[z,e("div",J,[e("span",{class:"iconfont icon-up icon",onClick:s[6]||(s[6]=t=>_("stock"))}),e("span",{class:"iconfont icon-down icon",onClick:s[7]||(s[7]=t=>f("stock"))})])]),K]),(a(!0),d(k,null,D(n.lists,t=>(a(),d("div",P,[b(e("input",{type:"checkbox",value:t,"onUpdate:modelValue":s[8]||(s[8]=i=>n.selectedLists=i),onChange:s[9]||(s[9]=(...i)=>o.selItem&&o.selItem(...i))},null,40,Q),[[h,n.selectedLists]]),e("div",R,c(t.name),1),e("div",null,c(t.price),1),e("div",null,c(t.stock),1),e("div",T,[e("button",{onClick:i=>m(t)},"-",8,W),e("div",X,c(t.quantity),1),e("button",{onClick:i=>g(t)},"+",8,Y)])]))),256)),e("div",Z,[e("div",null,"总价: "+c(I(v)),1),e("button",{class:"order-btn",onClick:s[10]||(s[10]=(...t)=>o.setOrder&&o.setOrder(...t))},"立即下单"),e("button",{class:"cart-btn",onClick:s[11]||(s[11]=(...t)=>o.setOrder&&o.setOrder(...t))},"找人代付")])],64)):(a(),d("div",ss,os))]))}},ds=A(ns,[["__scopeId","data-v-6dbef3bd"]]);export{ds as default};
