import{_ as pt,r as gt,o as yt,a as mt,c as It,d as St}from"./index-zaYE3T3a.js";import{t as xt,g as _,u as O,be as Dt,a5 as L,j,ar as bt,X as E,bf as Tt,bg as At,bh as wt,J as ut,a as W,f as lt,bi as _t,_ as X,a3 as at,Z as Mt,bb as Pt,ai as Vt,O as Lt,$ as Nt,a0 as Rt,a9 as Ct,D as kt,ap as G,ag as Ot,T as Et,bj as Bt,W as Ft,bk as Ht,b5 as Ut,a4 as Zt,aO as Gt,U as jt,A as k,bl as zt,N as Jt,ae as qt,af as $t}from"./installCanvasRenderer-CioQ-8se.js";import{g as rt}from"./sectorHelper-NGw3jD65.js";import{d as Wt}from"./dataFilter-Cxhk-D3S.js";var T=xt();function Xt(a){var t=a.mainData,e=a.datas;e||(e={main:t},a.datasAttr={main:"data"}),a.datas=a.mainData=null,ht(t,e,a),_(e,function(r){_(t.TRANSFERABLE_METHODS,function(n){r.wrapMethod(n,O(Yt,a))})}),t.wrapMethod("cloneShallow",O(Qt,a)),_(t.CHANGABLE_METHODS,function(r){t.wrapMethod(r,O(Kt,a))}),Dt(e[t.dataType]===t)}function Yt(a,t){if(ae(this)){var e=L({},T(this).datas);e[this.dataType]=t,ht(t,e,a)}else Y(t,this.dataType,T(this).mainData,a);return t}function Kt(a,t){return a.struct&&a.struct.update(),t}function Qt(a,t){return _(T(t).datas,function(e,r){e!==t&&Y(e.cloneShallow(),r,t,a)}),t}function te(a){var t=T(this).mainData;return a==null||t==null?t:T(t).datas[a]}function ee(){var a=T(this).mainData;return a==null?[{data:a}]:j(bt(T(a).datas),function(t){return{type:t,data:T(a).datas[t]}})}function ae(a){return T(a).mainData===a}function ht(a,t,e){T(a).datas={},_(t,function(r,n){Y(r,n,a,e)})}function Y(a,t,e,r){T(e).datas[t]=a,T(a).mainData=e,a.dataType=t,r.struct&&(a[r.structAttr]=r.struct,r.struct[r.datasAttr[t]]=a),a.getLinkedData=te,a.getLinkedDataAll=ee}var re=function(){function a(t,e){this.depth=0,this.height=0,this.dataIndex=-1,this.children=[],this.viewChildren=[],this.isExpand=!1,this.name=t||"",this.hostTree=e}return a.prototype.isRemoved=function(){return this.dataIndex<0},a.prototype.eachNode=function(t,e,r){ut(t)&&(r=e,e=t,t=null),t=t||{},W(t)&&(t={order:t});var n=t.order||"preorder",o=this[t.attr||"children"],i;n==="preorder"&&(i=e.call(r,this));for(var s=0;!i&&s<o.length;s++)o[s].eachNode(t,e,r);n==="postorder"&&e.call(r,this)},a.prototype.updateDepthAndHeight=function(t){var e=0;this.depth=t;for(var r=0;r<this.children.length;r++){var n=this.children[r];n.updateDepthAndHeight(t+1),n.height>e&&(e=n.height)}this.height=e+1},a.prototype.getNodeById=function(t){if(this.getId()===t)return this;for(var e=0,r=this.children,n=r.length;e<n;e++){var o=r[e].getNodeById(t);if(o)return o}},a.prototype.contains=function(t){if(t===this)return!0;for(var e=0,r=this.children,n=r.length;e<n;e++){var o=r[e].contains(t);if(o)return o}},a.prototype.getAncestors=function(t){for(var e=[],r=t?this:this.parentNode;r;)e.push(r),r=r.parentNode;return e.reverse(),e},a.prototype.getAncestorsIndices=function(){for(var t=[],e=this;e;)t.push(e.dataIndex),e=e.parentNode;return t.reverse(),t},a.prototype.getDescendantIndices=function(){var t=[];return this.eachNode(function(e){t.push(e.dataIndex)}),t},a.prototype.getValue=function(t){var e=this.hostTree.data;return e.getStore().get(e.getDimensionIndex(t||"value"),this.dataIndex)},a.prototype.setLayout=function(t,e){this.dataIndex>=0&&this.hostTree.data.setItemLayout(this.dataIndex,t,e)},a.prototype.getLayout=function(){return this.hostTree.data.getItemLayout(this.dataIndex)},a.prototype.getModel=function(t){if(!(this.dataIndex<0)){var e=this.hostTree,r=e.data.getItemModel(this.dataIndex);return r.getModel(t)}},a.prototype.getLevelModel=function(){return(this.hostTree.levelModels||[])[this.depth]},a.prototype.setVisual=function(t,e){this.dataIndex>=0&&this.hostTree.data.setItemVisual(this.dataIndex,t,e)},a.prototype.getVisual=function(t){return this.hostTree.data.getItemVisual(this.dataIndex,t)},a.prototype.getRawIndex=function(){return this.hostTree.data.getRawIndex(this.dataIndex)},a.prototype.getId=function(){return this.hostTree.data.getId(this.dataIndex)},a.prototype.getChildIndex=function(){if(this.parentNode){for(var t=this.parentNode.children,e=0;e<t.length;++e)if(t[e]===this)return e;return-1}return-1},a.prototype.isAncestorOf=function(t){for(var e=t.parentNode;e;){if(e===this)return!0;e=e.parentNode}return!1},a.prototype.isDescendantOf=function(t){return t!==this&&t.isAncestorOf(this)},a}(),ne=function(){function a(t){this.type="tree",this._nodes=[],this.hostModel=t}return a.prototype.eachNode=function(t,e,r){this.root.eachNode(t,e,r)},a.prototype.getNodeByDataIndex=function(t){var e=this.data.getRawIndex(t);return this._nodes[e]},a.prototype.getNodeById=function(t){return this.root.getNodeById(t)},a.prototype.update=function(){for(var t=this.data,e=this._nodes,r=0,n=e.length;r<n;r++)e[r].dataIndex=-1;for(var r=0,n=t.count();r<n;r++)e[t.getRawIndex(r)].dataIndex=r},a.prototype.clearLayouts=function(){this.data.clearItemLayouts()},a.createTree=function(t,e,r){var n=new a(e),o=[],i=1;s(t);function s(v,d){var p=v.value;i=Math.max(i,E(p)?p.length:1),o.push(v);var y=new re(Tt(v.name,""),n);d?ie(y,d):n.root=y,n._nodes.push(y);var x=v.children;if(x)for(var D=0;D<x.length;D++)s(x[D],y)}n.root.updateDepthAndHeight(0);var l=At(o,{coordDimensions:["value"],dimensionsCount:i}).dimensions,c=new wt(l,e);return c.initData(o),r&&r(c),Xt({mainData:c,struct:n,structAttr:"tree"}),n.update(),n},a}();function ie(a,t){var e=t.children;a.parentNode!==t&&(e.push(a),a.parentNode=t)}function nt(a,t,e){if(a&&lt(t,a.type)>=0){var r=e.getData().tree.root,n=a.targetNode;if(W(n)&&(n=r.getNodeById(n)),n&&r.contains(n))return{node:n};var o=a.targetNodeId;if(o!=null&&(n=r.getNodeById(o)))return{node:n}}}function oe(a){for(var t=[];a;)a=a.parentNode,a&&t.push(a);return t.reverse()}function se(a,t){var e=oe(a);return lt(e,t)>=0}function ue(a,t){for(var e=[];a;){var r=a.dataIndex;e.push({name:a.name,dataIndex:r,value:t.getRawValue(r)}),a=a.parentNode}return e.reverse(),e}function le(a){var t=a.getData(),e=t.tree,r={};e.eachNode(function(n){for(var o=n;o&&o.depth>1;)o=o.parentNode;var i=_t(a.ecModel,o.name||o.dataIndex+"",r);n.setVisual("decal",i)})}var he=2,ce=4,it=function(a){X(t,a);function t(e,r,n,o){var i=a.call(this)||this;i.z2=he,i.textConfig={inside:!0},at(i).seriesIndex=r.seriesIndex;var s=new Mt({z2:ce,silent:e.getModel().get(["label","silent"])});return i.setTextContent(s),i.updateData(!0,e,r,n,o),i}return t.prototype.updateData=function(e,r,n,o,i){this.node=r,r.piece=this,n=n||this._seriesModel,o=o||this._ecModel;var s=this;at(s).dataIndex=r.dataIndex;var l=r.getModel(),c=l.getModel("emphasis"),v=r.getLayout(),d=L({},v);d.label=null;var p=r.getVisual("style");p.lineJoin="bevel";var y=r.getVisual("decal");y&&(p.decal=Pt(y,i));var x=rt(l.getModel("itemStyle"),d,!0);L(d,x),_(Vt,function(u){var h=s.ensureState(u),f=l.getModel([u,"itemStyle"]);h.style=f.getItemStyle();var S=rt(f,d);S&&(h.shape=S)}),e?(s.setShape(d),s.shape.r=v.r0,Lt(s,{shape:{r:v.r}},n,r.dataIndex)):(Nt(s,{shape:d},n),Rt(s)),s.useStyle(p),this._updateLabel(n);var D=l.getShallow("cursor");D&&s.attr("cursor",D),this._seriesModel=n||this._seriesModel,this._ecModel=o||this._ecModel;var g=c.get("focus"),m=g==="ancestor"?r.getAncestorsIndices():g==="descendant"?r.getDescendantIndices():g;Ct(this,m,c.get("blurScope"),c.get("disabled"))},t.prototype._updateLabel=function(e){var r=this,n=this.node.getModel(),o=n.getModel("label"),i=this.node.getLayout(),s=i.endAngle-i.startAngle,l=(i.startAngle+i.endAngle)/2,c=Math.cos(l),v=Math.sin(l),d=this,p=d.getTextContent(),y=this.node.dataIndex,x=o.get("minAngle")/180*Math.PI,D=o.get("show")&&!(x!=null&&Math.abs(s)<x);p.ignore=!D,_(Ot,function(m){var u=m==="normal"?n.getModel("label"):n.getModel([m,"label"]),h=m==="normal",f=h?p:p.ensureState(m),S=e.getFormattedLabel(y,m);h&&(S=S||r.node.name),f.style=kt(u,{},null,m!=="normal",!0),S&&(f.style.text=S);var A=u.get("show");A!=null&&!h&&(f.ignore=!A);var N=g(u,"position"),P=h?d:d.states[m],R=P.style.fill;P.textConfig={outsideFill:u.get("color")==="inherit"?R:null,inside:N!=="outside"};var M,B=g(u,"distance")||0,b=g(u,"align"),C=g(u,"rotate"),F=Math.PI*.5,H=Math.PI*1.5,I=G(C==="tangential"?Math.PI/2-l:l),w=I>F&&!Bt(I-F)&&I<H;N==="outside"?(M=i.r+B,b=w?"right":"left"):!b||b==="center"?(s===2*Math.PI&&i.r0===0?M=0:M=(i.r+i.r0)/2,b="center"):b==="left"?(M=i.r0+B,b=w?"right":"left"):b==="right"&&(M=i.r-B,b=w?"left":"right"),f.style.align=b,f.style.verticalAlign=g(u,"verticalAlign")||"middle",f.x=M*c+i.cx,f.y=M*v+i.cy;var V=0;C==="radial"?V=G(-l)+(w?Math.PI:0):C==="tangential"?V=G(Math.PI/2-l)+(w?Math.PI:0):Ft(C)&&(V=C*Math.PI/180),f.rotation=G(V)});function g(m,u){var h=m.get(u);return h??o.get(u)}p.dirtyStyle()},t}(Et),$="sunburstRootToNode",ot="sunburstHighlight",de="sunburstUnhighlight";function ve(a){a.registerAction({type:$,update:"updateView"},function(t,e){e.eachComponent({mainType:"series",subType:"sunburst",query:t},r);function r(n,o){var i=nt(t,[$],n);if(i){var s=n.getViewRoot();s&&(t.direction=se(s,i.node)?"rollUp":"drillDown"),n.resetViewRoot(i.node)}}}),a.registerAction({type:ot,update:"none"},function(t,e,r){t=L({},t),e.eachComponent({mainType:"series",subType:"sunburst",query:t},n);function n(o){var i=nt(t,[ot],o);i&&(t.dataIndex=i.node.dataIndex)}r.dispatchAction(L(t,{type:"highlight"}))}),a.registerAction({type:de,update:"updateView"},function(t,e,r){t=L({},t),r.dispatchAction(L(t,{type:"downplay"}))})}var fe=function(a){X(t,a);function t(){var e=a!==null&&a.apply(this,arguments)||this;return e.type=t.type,e}return t.prototype.render=function(e,r,n,o){var i=this;this.seriesModel=e,this.api=n,this.ecModel=r;var s=e.getData(),l=s.tree.root,c=e.getViewRoot(),v=this.group,d=e.get("renderLabelForZeroData"),p=[];c.eachNode(function(u){p.push(u)});var y=this._oldChildren||[];x(p,y),m(l,c),this._initEvents(),this._oldChildren=p;function x(u,h){if(u.length===0&&h.length===0)return;new Ht(h,u,f,f).add(S).update(S).remove(O(S,null)).execute();function f(A){return A.getId()}function S(A,N){var P=A==null?null:u[A],R=N==null?null:h[N];D(P,R)}}function D(u,h){if(!d&&u&&!u.getValue()&&(u=null),u!==l&&h!==l){if(h&&h.piece)u?(h.piece.updateData(!1,u,e,r,n),s.setItemGraphicEl(u.dataIndex,h.piece)):g(h);else if(u){var f=new it(u,e,r,n);v.add(f),s.setItemGraphicEl(u.dataIndex,f)}}}function g(u){u&&u.piece&&(v.remove(u.piece),u.piece=null)}function m(u,h){h.depth>0?(i.virtualPiece?i.virtualPiece.updateData(!1,u,e,r,n):(i.virtualPiece=new it(u,e,r,n),v.add(i.virtualPiece)),h.piece.off("click"),i.virtualPiece.on("click",function(f){i._rootToNode(h.parentNode)})):i.virtualPiece&&(v.remove(i.virtualPiece),i.virtualPiece=null)}},t.prototype._initEvents=function(){var e=this;this.group.off("click"),this.group.on("click",function(r){var n=!1,o=e.seriesModel.getViewRoot();o.eachNode(function(i){if(!n&&i.piece&&i.piece===r.target){var s=i.getModel().get("nodeClick");if(s==="rootToNode")e._rootToNode(i);else if(s==="link"){var l=i.getModel(),c=l.get("link");if(c){var v=l.get("target",!0)||"_blank";Ut(c,v)}}n=!0}})})},t.prototype._rootToNode=function(e){e!==this.seriesModel.getViewRoot()&&this.api.dispatchAction({type:$,from:this.uid,seriesId:this.seriesModel.id,targetNode:e})},t.prototype.containPoint=function(e,r){var n=r.getData(),o=n.getItemLayout(0);if(o){var i=e[0]-o.cx,s=e[1]-o.cy,l=Math.sqrt(i*i+s*s);return l<=o.r&&l>=o.r0}},t.type="sunburst",t}(Zt);const pe=fe;var ge=function(a){X(t,a);function t(){var e=a!==null&&a.apply(this,arguments)||this;return e.type=t.type,e.ignoreStyleOnData=!0,e}return t.prototype.getInitialData=function(e,r){var n={name:e.name,children:e.data};ct(n);var o=this._levelModels=j(e.levels||[],function(l){return new Gt(l,this,r)},this),i=ne.createTree(n,this,s);function s(l){l.wrapMethod("getItemModel",function(c,v){var d=i.getNodeByDataIndex(v),p=o[d.depth];return p&&(c.parentModel=p),c})}return i.data},t.prototype.optionUpdated=function(){this.resetViewRoot()},t.prototype.getDataParams=function(e){var r=a.prototype.getDataParams.apply(this,arguments),n=this.getData().tree.getNodeByDataIndex(e);return r.treePathInfo=ue(n,this),r},t.prototype.getLevelModel=function(e){return this._levelModels&&this._levelModels[e.depth]},t.prototype.getViewRoot=function(){return this._viewRoot},t.prototype.resetViewRoot=function(e){e?this._viewRoot=e:e=this._viewRoot;var r=this.getRawData().tree.root;(!e||e!==r&&!r.contains(e))&&(this._viewRoot=r)},t.prototype.enableAriaDecal=function(){le(this)},t.type="series.sunburst",t.defaultOption={z:2,center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,stillShowZeroSum:!0,nodeClick:"rootToNode",renderLabelForZeroData:!1,label:{rotate:"radial",show:!0,opacity:1,align:"center",position:"inside",distance:5,silent:!0},itemStyle:{borderWidth:1,borderColor:"white",borderType:"solid",shadowBlur:0,shadowColor:"rgba(0, 0, 0, 0.2)",shadowOffsetX:0,shadowOffsetY:0,opacity:1},emphasis:{focus:"descendant"},blur:{itemStyle:{opacity:.2},label:{opacity:.1}},animationType:"expansion",animationDuration:1e3,animationDurationUpdate:500,data:[],sort:"desc"},t}(jt);function ct(a){var t=0;_(a.children,function(r){ct(r);var n=r.value;E(n)&&(n=n[0]),t+=n});var e=a.value;E(e)&&(e=e[0]),(e==null||isNaN(e))&&(e=t),e<0&&(e=0),E(a.value)?a.value[0]=e:a.value=e}const ye=ge;var st=Math.PI/180;function me(a,t,e){t.eachSeriesByType(a,function(r){var n=r.get("center"),o=r.get("radius");E(o)||(o=[0,o]),E(n)||(n=[n,n]);var i=e.getWidth(),s=e.getHeight(),l=Math.min(i,s),c=k(n[0],i),v=k(n[1],s),d=k(o[0],l/2),p=k(o[1],l/2),y=-r.get("startAngle")*st,x=r.get("minAngle")*st,D=r.getData().tree.root,g=r.getViewRoot(),m=g.depth,u=r.get("sort");u!=null&&dt(g,u);var h=0;_(g.children,function(I){!isNaN(I.getValue())&&h++});var f=g.getValue(),S=Math.PI/(f||h)*2,A=g.depth>0,N=g.height-(A?-1:1),P=(p-d)/(N||1),R=r.get("clockwise"),M=r.get("stillShowZeroSum"),B=R?1:-1,b=function(I,w){if(I){var V=w;if(I!==D){var vt=I.getValue(),U=f===0&&M?S:vt*S;U<x&&(U=x),V=w+B*U;var K=I.depth-m-(A?-1:1),Q=d+P*K,tt=d+P*(K+1),Z=r.getLevelModel(I);if(Z){var z=Z.get("r0",!0),J=Z.get("r",!0),q=Z.get("radius",!0);q!=null&&(z=q[0],J=q[1]),z!=null&&(Q=k(z,l/2)),J!=null&&(tt=k(J,l/2))}I.setLayout({angle:U,startAngle:w,endAngle:V,clockwise:R,cx:c,cy:v,r0:Q,r:tt})}if(I.children&&I.children.length){var et=0;_(I.children,function(ft){et+=b(ft,w+et)})}return V-w}};if(A){var C=d,F=d+P,H=Math.PI*2;D.setLayout({angle:H,startAngle:y,endAngle:y+H,clockwise:R,cx:c,cy:v,r0:C,r:F})}b(g,y)})}function dt(a,t){var e=a.children||[];a.children=Ie(e,t),e.length&&_(a.children,function(r){dt(r,t)})}function Ie(a,t){if(ut(t)){var e=j(a,function(n,o){var i=n.getValue();return{params:{depth:n.depth,height:n.height,dataIndex:n.dataIndex,getValue:function(){return i}},index:o}});return e.sort(function(n,o){return t(n.params,o.params)}),j(e,function(n){return a[n.index]})}else{var r=t==="asc";return a.sort(function(n,o){var i=(n.getValue()-o.getValue())*(r?1:-1);return i===0?(n.dataIndex-o.dataIndex)*(r?-1:1):i})}}function Se(a){var t={};function e(r,n,o){for(var i=r;i&&i.depth>1;)i=i.parentNode;var s=n.getColorFromPalette(i.name||i.dataIndex+"",t);return r.depth>1&&W(s)&&(s=zt(s,(r.depth-1)/(o-1)*.5)),s}a.eachSeriesByType("sunburst",function(r){var n=r.getData(),o=n.tree;o.eachNode(function(i){var s=i.getModel(),l=s.getModel("itemStyle").getItemStyle();l.fill||(l.fill=e(i,r,o.root.height));var c=n.ensureUniqueItemVisual(i.dataIndex,"style");L(c,l)})})}function xe(a){a.registerChartView(pe),a.registerSeriesModel(ye),a.registerLayout(O(me,"sunburst")),a.registerProcessor(O(Wt,"sunburst")),a.registerVisual(Se),ve(a)}const De={class:"sun"},be={__name:"Sun",setup(a){let t=gt(null);Jt([xe,$t]);let e;return e={series:{type:"sunburst",data:[{name:"Grandpa",children:[{name:"Uncle Leo",value:15,children:[{name:"Cousin Jack",value:2},{name:"Cousin Mary",value:5,children:[{name:"Jackson",value:2}]},{name:"Cousin Ben",value:4}]},{name:"Father",value:10,children:[{name:"Me",value:5},{name:"Brother Peter",value:1}]}]},{name:"Nancy",children:[{name:"Uncle Nike",children:[{name:"Cousin Betty",value:1},{name:"Cousin Jenny",value:2}]}]}],radius:[0,"90%"],label:{rotate:"radial"}}},yt(()=>{let n=qt(t.value);e&&n.setOption(e)}),(n,o)=>(mt(),It("div",De,[St("div",{class:"chart",ref_key:"main",ref:t},null,512)]))}},Me=pt(be,[["__scopeId","data-v-6180f07f"]]);export{Me as default};
