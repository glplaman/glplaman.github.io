import{_ as D,r as f,G as N,o as x,m as I,y as b,c as i,F as g,d as e,z as w,H as y,s as O,t as c,e as _,f as U,a,p as V,k as B}from"./index-C0kaU_JG.js";import{u as F}from"./cart-ixJNYOJ3.js";import{N as M}from"./Notice-jwjBIq-d.js";import"./api-CvFuAddq.js";const l=d=>(V("data-v-f6cb2854"),d=d(),B(),d),z={class:"cart"},E={class:"item leading"},G={class:"leading-title"},H=l(()=>e("span",null,"商品",-1)),T={class:"sort-box"},j={class:"leading-title"},J=l(()=>e("span",null,"单价",-1)),K={class:"sort-box"},P={class:"leading-title"},Q=l(()=>e("span",null,"库存",-1)),R={class:"sort-box"},W=l(()=>e("div",null,"操作",-1)),X={class:"item"},Y=["value"],Z={class:"ellipsis"},ss={class:"btn-group"},ts=["onClick"],es={class:"number"},os=["onClick"],ns={class:"total"},ls={key:1,class:"empty"},is=l(()=>e("span",{class:"iconfont icon-cart-full-fill"},null,-1)),cs=l(()=>e("div",null,"购物车为空",-1)),as=[is,cs],ds={__name:"Cart",setup(d){const r=F();let u=f(!1),k=f("");const n=N({selectedAll:!1,selectedLists:[],lists:[]});let C=f(0);const S=o=>{o.quantity<o.stock&&o.quantity++},A=o=>{o.quantity>1&&o.quantity--},h=o=>{n.lists.sort((s,t)=>s[o]-t[o])},m=o=>{n.lists.sort((s,t)=>t[o]-s[o])},L=o=>{n.lists.sort((s,t)=>s[o].localeCompare(t[o]))},$=o=>{n.lists.sort((s,t)=>t[o].localeCompare(s[o]))};x(()=>{r.cart.length||(r.fetchCart(),q("数据加载完毕")),n.lists=I(()=>r.cart)});let p=!0;b(()=>n.selectedAll,o=>{o?n.selectedLists=[...n.lists]:p&&(n.selectedLists=[])}),b(()=>n.selectedLists,o=>{o.length==n.lists.length&&n.lists.length?(n.selectedAll=!0,p=!0):(n.selectedAll=!1,p=!1),C.value=n.selectedLists.reduce((s,t)=>s+t.quantity*t.price,0).toFixed(2)},{deep:!0,immediate:!0});const q=o=>{u.value=!0,k.value=o,setTimeout(()=>{u.value=!1},3e3)};return(o,s)=>(a(),i("div",z,[n.lists.length?(a(),i(g,{key:0},[e("div",E,[w(e("input",{type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=t=>n.selectedAll=t),onChange:s[1]||(s[1]=(...t)=>o.selAll&&o.selAll(...t))},null,544),[[y,n.selectedAll]]),e("div",G,[H,e("div",T,[e("span",{class:"iconfont icon-up icon",onClick:s[2]||(s[2]=t=>L("name"))}),e("span",{class:"iconfont icon-down icon",onClick:s[3]||(s[3]=t=>$("name"))})])]),e("div",j,[J,e("div",K,[e("span",{class:"iconfont icon-up icon",onClick:s[4]||(s[4]=t=>h("price"))}),e("span",{class:"iconfont icon-down icon",onClick:s[5]||(s[5]=t=>m("price"))})])]),e("div",P,[Q,e("div",R,[e("span",{class:"iconfont icon-up icon",onClick:s[6]||(s[6]=t=>h("stock"))}),e("span",{class:"iconfont icon-down icon",onClick:s[7]||(s[7]=t=>m("stock"))})])]),W]),(a(!0),i(g,null,O(n.lists,t=>(a(),i("div",X,[w(e("input",{type:"checkbox",value:t,"onUpdate:modelValue":s[8]||(s[8]=v=>n.selectedLists=v)},null,8,Y),[[y,n.selectedLists]]),e("div",Z,c(t.name),1),e("div",null,c(t.price),1),e("div",null,c(t.stock),1),e("div",ss,[e("button",{onClick:v=>A(t)},"-",8,ts),e("div",es,c(t.quantity),1),e("button",{onClick:v=>S(t)},"+",8,os)])]))),256)),e("div",ns,[e("div",null,"总价: "+c(_(C)),1),e("button",{class:"order-btn",onClick:s[9]||(s[9]=(...t)=>o.setOrder&&o.setOrder(...t))},"立即下单"),e("button",{class:"cart-btn",onClick:s[10]||(s[10]=(...t)=>o.setOrder&&o.setOrder(...t))},"找人代付")])],64)):(a(),i("div",ls,as)),U(M,{flag:_(u),tips:_(k)},null,8,["flag","tips"])]))}},fs=D(ds,[["__scopeId","data-v-f6cb2854"]]);export{fs as default};
