import{_ as h,r as l,a as v,c as k,d as s,f as y,e as p,N as x,A as d}from"./index-CLJThBxz.js";const N={class:"avatar"},I={class:"avatar-box"},U=["src"],b={__name:"Avatar",props:{user:{type:Object,default:()=>({})}},setup(c){let o=l(!1),r=l("");const n=c;let i=l(null);const f=()=>{i.value.click()},m=e=>{console.log(e.target.files[0]);let a=e.target.files[0];g(a)},g=e=>{let a=new FormData;a.append("image",e),d.post("/api/uploadimg",a,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{console.log("then",t),_({usn:n.user.usn,ukey:"imgUrl",uvalue:t.data.data.url}),n.user.imgUrl=t.data.data.url}).catch(t=>{console.log("err",t)})},_=e=>{d.post("/user/modify",e).then(a=>{console.log("then",a),u("修改成功")}).catch(a=>{console.log("err",a),u("修改失败")})},u=e=>{o.value=!0,r.value=e,setTimeout(()=>{o.value=!1},3e3)};return(e,a)=>(v(),k("div",N,[s("div",I,[s("img",{src:c.user.imgUrl,alt:""},null,8,U),s("input",{type:"file",name:"image",ref_key:"ipt",ref:i,accept:"image/*",hidden:"",onChange:m},null,544),s("div",{class:"avatar-btn",onClick:f},"上传头像")]),y(x,{flag:p(o),tips:p(r)},null,8,["flag","tips"])]))}},A=h(b,[["__scopeId","data-v-fe9399c3"]]);export{A as default};
