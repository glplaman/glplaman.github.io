import{_ as A,r as c,o as E,v as R,c as v,d as t,g as o,F as x,m as y,e as n,x as C,y as N,h as $,z as j,f as L,N as G,A as H,a as p,t as g,n as V,q as J,B as K,i as O,p as P,k as Q}from"./index-CLJThBxz.js";import{u as W,w as X}from"./xlsx-ChWuxSKv.js";const l=b=>(P("data-v-ec82c381"),b=b(),Q(),b),Y={class:"user"},Z=l(()=>t("span",{class:"iconfont icon-customer-fill"},null,-1)),tt=l(()=>t("span",{class:"iconfont icon-change"},null,-1)),st=l(()=>t("span",{class:"iconfont icon-excel-full"},null,-1)),et=l(()=>t("tr",{class:"tbl-header"},[t("th",null,[o("学号"),t("br"),t("span",null,"usn")]),t("th",null,[o("昵称"),t("br"),t("span",null,"uname")]),t("th",null,[o("头像"),t("br"),t("span",null,"uavatar")]),t("th",null,[o("积分"),t("br"),t("span",null,"ucredit")]),t("th",null,[o("操作"),t("br"),t("span",null,"uoper")])],-1)),at={hidden:""},lt=["src"],nt={class:"btn-group"},ot=["onClick"],ut=l(()=>t("span",{class:"iconfont icon-edit"},null,-1)),it=[ut],ct=["onClick"],rt=l(()=>t("span",{class:"iconfont icon-delete-fill"},null,-1)),dt=[rt],_t={key:0,class:"add-user-wrap"},vt=l(()=>t("h3",{class:"dia-title"},"add user",-1)),pt={class:"dia-cont"},ht={class:"add-item"},bt=l(()=>t("span",null,"学号",-1)),ft={class:"add-item"},mt=l(()=>t("span",null,"昵称",-1)),gt={class:"add-item"},kt=l(()=>t("span",null,"头像",-1)),xt={class:"img-box"},yt=["value"],Ct={class:"add-item"},wt=l(()=>t("span",null,"积分",-1)),St=["onClick"],Ut=l(()=>t("button",{class:"add",type:"submit"},[o("提交 "),t("span",{class:"iconfont icon-tick"})],-1)),It=l(()=>t("span",{class:"iconfont icon-close"},null,-1)),Nt={__name:"User",setup(b){let f=c(!1),w=c(""),B=c(null),k=c(null),_=c([]),m=c(!1),r=c(-1),e=c({usn:"",uname:"",uavatar:"",ucredit:0});const S=s=>{m.value=!0,s&&(e.value={...s})},D=s=>{console.log(s),_.value.splice(s,1)},F=()=>{m.value=!1,f.value=!1,I()},M=()=>{if(!e.value.usn){console.log("user sn is null"),u("学号不能为空");return}if(!e.value.uname){console.log("user name is null"),u("用户昵称不能为空");return}if(!e.value.uavatar){console.log("user avatar is null"),u("用户头像不能为空");return}if(!e.value.ucredit){console.log("user credit is null"),u("用户积分不能为空");return}m.value=!1,_.value.unshift(e.value),u("添加用户成功"),I()},q=s=>{console.log(s),e.value.ucredit=s+1},z=()=>{if(k.value){let s=W.table_to_book(k.value);X(s,"user.xlsx"),u("导出成功")}else console.log("tbl is null"),u("导出失败")},U=()=>{H.get("https://glpla.github.io/utils/data/data2024/rank202401.json").then(s=>{_.value=[..._.value,...s.data.cont],u("数据加载完毕")})},T=()=>{_.value=[],U()};E(()=>{U()});const I=()=>{e.value={usn:"",uname:"",uavatar:"",ucredit:0},r.value=-1};R(r,(s,d)=>{e.value.uavatar="/avatar/avatar"+s+".png"},{immediate:!0});const u=s=>{f.value=!0,w.value=s,setTimeout(()=>{f.value=!1},3e3)};return(s,d)=>(p(),v("div",Y,[t("div",{class:"btns-box"},[t("button",{class:"btn add-user-btn",onClick:S},[o("添加 "),Z]),t("button",{class:"btn add-user-btn btn1",onClick:T},[o("刷新 "),tt]),t("button",{class:"btn add-user-btn btn2",onClick:z},[o("导出 "),st])]),t("div",{class:"tbl-box",ref_key:"tblBox",ref:B},[t("table",{ref_key:"tbl",ref:k},[et,(p(!0),v(x,null,y(n(_),(a,i)=>(p(),v("tr",{key:a.id},[t("td",null,g(a.usn),1),t("td",null,g(a.uname),1),t("td",null,[t("span",at,g(a.uavatar),1),t("img",{class:"img-avatar",src:"https://glpla.github.io/utils"+a.uavatar,alt:"user avatar"},null,8,lt)]),t("td",null,g(a.ucredit),1),t("td",nt,[t("button",{class:"btn edit-btn",onClick:h=>S(a)},it,8,ot),t("button",{class:"btn del-btn",onClick:h=>D(i)},dt,8,ct)])]))),128))],512)],512),n(m)?(p(),v("div",_t,[t("form",{onSubmit:$(M,["prevent"])},[vt,t("div",pt,[t("div",ht,[bt,C(t("input",{type:"text",placeholder:"your sn",name:"usn","onUpdate:modelValue":d[0]||(d[0]=a=>n(e).usn=a),required:""},null,512),[[N,n(e).usn,void 0,{trim:!0}]])]),t("div",ft,[mt,C(t("input",{type:"text",placeholder:"your name",name:"uname","onUpdate:modelValue":d[1]||(d[1]=a=>n(e).uname=a),required:""},null,512),[[N,n(e).uname,void 0,{trim:!0}]])]),t("div",gt,[kt,t("div",xt,[(p(),v(x,null,y(10,(a,i)=>t("label",{class:V(["avatar-img",{active:n(r)==i}]),style:J({backgroundImage:"url(https://glpla.github.io/utils/avatar/avatar"+i+".png)"})},[C(t("input",{type:"radio",name:"uavatar",value:i,"onUpdate:modelValue":d[2]||(d[2]=h=>O(r)?r.value=h:r=h),hidden:""},null,8,yt),[[K,n(r)]])],6)),64))])]),t("div",Ct,[wt,t("div",null,[(p(),v(x,null,y(10,(a,i)=>t("span",{class:V(["iconfont icon-favorites credit-icon",{active:i<n(e).ucredit}]),key:a,onClick:h=>q(i)},null,10,St)),64))])]),t("div",{class:"btn-group"},[Ut,t("button",{class:"cancle",type:"button",onClick:F},[o("取消 "),It])])])],32)])):j("",!0),L(G,{flag:n(f),tips:n(w)},null,8,["flag","tips"])]))}},Dt=A(Nt,[["__scopeId","data-v-ec82c381"]]);export{Dt as default};
