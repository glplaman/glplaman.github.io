import{_ as b,f as i,o as w,c as N,b as e,a as _,A as h,i as d,m as f,l as S,j as V,N as q,P as r,C as I,q as U,s as k}from"./index-CeVYWr2Z.js";const c=l=>(U("data-v-ce0d85b0"),l=l(),k(),l),z={class:"pass"},B={class:"item"},P=c(()=>e("div",null,"旧密码",-1)),j={class:"item"},E=c(()=>e("div",null,"新密码",-1)),M={class:"item"},T=c(()=>e("div",null,"确认新密码",-1)),A=c(()=>e("div",{class:"btn-group"},[e("button",{type:"submit"},"提交"),e("button",{type:"reset"},"取消")],-1)),C={__name:"Pass",props:{user:{type:Object,default:()=>({})}},setup(l){const m=l;let a=i(""),t=i(""),u=i(""),v=i(!1),g=i("");const x=()=>{if(m.user.upass!==r.md5(a.value)){console.log("pass not match"),n("旧密码错误");return}if(t.value!==u.value){console.log("new pass not consistent"),n("新密码不一致");return}if(t.value==a.value){console.log("pass not change"),n("新密码与旧密码相同");return}console.log(r.md5(t.value)),y({usn:m.user.usn,ukey:"upass",uvalue:r.md5(t.value)}),m.user.upass=r.md5(t.value)},y=p=>{I.post("/user/modify",p).then(s=>{console.log("then",s),n("修改成功")}).catch(s=>{console.log("err",s),n("修改失败")})},n=p=>{v.value=!0,g.value=p,setTimeout(()=>{v.value=!1},3e3)};return(p,s)=>(w(),N("div",z,[e("form",{onSubmit:S(x,["prevent"])},[e("div",B,[P,_(e("input",{type:"text",name:"oldupass",maxlength:"16",required:"","onUpdate:modelValue":s[0]||(s[0]=o=>f(a)?a.value=o:a=o),placeholder:"16个字符以内"},null,512),[[h,d(a),void 0,{lazy:!0}]])]),e("div",j,[E,_(e("input",{type:"text",name:"newpass",maxlength:"16",required:"","onUpdate:modelValue":s[1]||(s[1]=o=>f(t)?t.value=o:t=o),placeholder:"16个字符以内"},null,512),[[h,d(t),void 0,{lazy:!0}]])]),e("div",M,[T,_(e("input",{type:"text",name:"temppass",maxlength:"16","onUpdate:modelValue":s[2]||(s[2]=o=>f(u)?u.value=o:u=o),required:"",placeholder:"16个字符以内"},null,512),[[h,d(u),void 0,{lazy:!0}]])]),A],32),V(q,{flag:d(v),tips:d(g)},null,8,["flag","tips"])]))}},O=b(C,[["__scopeId","data-v-ce0d85b0"]]);export{O as default};
