<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>用户界面交互 UI</title>
  <link rel="stylesheet" href="../css/common2025.css">
  <base target="_blank">
</head>

<body>
  <header>
    <h1>用户界面交互</h1>
    <span>&commat;UI</span>
  </header>
  <section>
    <ul>
      <li>UI操作会挂起进程，注意语句的执行顺序会被打乱</li>
      <li>更多 API，请访问 <a href="https://developers.weixin.qq.com/miniprogram/dev/api/">官方文档 - API - 界面</a></li>
    </ul>
    <h3>wx.showToast(Object object)</h3>
    <ul>
      <li>显示消息提示框</li>
      <li>title - 提示信息</li>
      <li>icon - 提示图标；系统内置，数量教少</li>
      <li>image - 自定义图片；使用后配置项 icon 无效</li>
      <li>mask - 默认为 false；建议开启，增加透明遮罩层，避免事件穿透</li>
      <li>success - 成功后的回调函数</li>
      <li>fail - 识别后的回调函数</li>
      <li>complete - 完成后的回调函数</li>
      <li>修改昵称后，延时1秒返回上级</li>
      <pre>
wx.showToast({
  title: '用户昵称修改成功',
  success: () => {
    setTimeout(() => {
      wx.navigateBack({
        delta: 1,
        success: (res) => {},
        fail: (res) => {},
        complete: (res) => {},
      })
    }, 1000)
  }
})</pre>
    </ul>
    <h3>wx.hideToast(Object object)</h3>
    <div>. 隐藏消息提示框</div>
    <h3>wx.showLoading(Object object)</h3>
    <div>. 显示 loading 提示框</div>
    <h3>wx.hideLoading(Object object)</h3>
    <div>. 隐藏 loading 提示框</div>
    <h3>wx.showModal(Object object)</h3>
    <ul>
      <li>显示模态对话框；通过判断 res.confirm 还是 res.cancel 确定下一步操作</li>
      <li>title - 提示标题</li>
      <li>content - 提示内容</li>
      <li>editable - 可编辑；确认后在返回结果 res的 content 中获取</li>
      <li>placeholderText - 占位符，显示输入框时的提示文本，此时 content 相当于值</li>
    </ul>
    <div>[<span class="iconfont icon-keyboard"></span>] 使用编辑 editable 和占位 placeholderText 提供交互 - 修改个人信息</div>
    <ul>
      <li>优点：不用页面跳转；不用专门创建页面</li>
      <pre>
wx.showModal({
    title: 'rename',
    content: this.data.user.uname,
    editable: true,
    placeholderText: '8 chars',
    complete: (res) => {
        if (res.cancel) {
            console.log('cancel', res);
        }
        if (res.confirm) {
            console.log('confirm', res);
            this.setData({
                'user.uname': res.content
            })
        }
    }
})</pre>
    </ul>
    <h3>wx.showActionSheet(Object object)</h3>
    <ul>
      <li>可以看作是 radio / picker 的一种拓展</li>
      <li>显示操作菜单；在事件对象 res 获取选中的列表 tapIndex</li>
      <li>alertText - 提示文案</li>
      <li>itemList - 待选列表项，长度最大为6 </li>
    </ul>
    <div>[<span class="iconfont icon-keyboard"></span>] 选择性别</div>
    <ul>
      <li>页面提供的 gender 数据，不直接参与页面渲染，可以作为静态数据声明</li>
      <li>alertText 用来给出提示信息</li>
      <li>数据更新：全局状态、本地存储</li>
      <pre>
data: {
    userInfo: {
        userGender: 'Male',
    },    
}
gender: ['Male', 'Female']</pre>
      <pre>
chooseGender() {
  wx.showActionSheet({
    alertText: '性别选择',
    itemList: ['Male', 'Female'],
    success: (res) => {
      let userInfo = this.data.userInfo
      userInfo.userGender = this.gender[res.tapIndex]
      // 全局更新
      app.globalData.userInfo = userInfo
      // 本地存储同步更新
      wx.setStorageSync('userInfo', userInfo)
      this.setData({
        userInfo
      })
    },
    fail: (e) => {
      wx.showToast({
        title: '请稍后再试',
      })
    },
    complete: () => {
      wx.showToast({
        title: '性别选择完毕',
      })
    }
  })
}</pre>
    </ul>
  </section>
  <h2>导航栏 Navigation bar</h2>
  <section>
    <h3><a
        href="https://developers.weixin.qq.com/miniprogram/dev/api/ui/navigation-bar/wx.setNavigationBarTitle.html">wx.setNavigationBarTitle(Object
        object)</a></h3>
    <div>. 设置当前页面的标题</div>
    <h3><a
        href="https://developers.weixin.qq.com/miniprogram/dev/api/ui/navigation-bar/wx.setNavigationBarColor.html">wx.setNavigationBarColor(Object
        object)</a></h3>
    <div>. 设置页面导航条颜色</div>
    <h3><a
        href="https://developers.weixin.qq.com/miniprogram/dev/api/ui/navigation-bar/wx.showNavigationBarLoading.html">wx.showNavigationBarLoading(Object
        object)</a></h3>
    <div>. 在当前页面显示导航条加载动画</div>
    <h3><a
        href="https://developers.weixin.qq.com/miniprogram/dev/api/ui/navigation-bar/wx.hideNavigationBarLoading.html">wx.hideNavigationBarLoading(Object
        object)</a></h3>
    <div>. 在当前页面隐藏导航条加载动画</div>
  </section>
  <h2>标签栏 TabBar</h2>
  <section>
    <h3><a
        href="https://developers.weixin.qq.com/miniprogram/dev/api/ui/tab-bar/wx.showTabBarRedDot.html">wx.showTabBarRedDot(Object
        object)</a></h3>
    <div>. 显示 tabBar 某一项的右上角的红点</div>
    <div>. 与之对应的隐藏 <a
        href="https://developers.weixin.qq.com/miniprogram/dev/api/ui/tab-bar/wx.hideTabBarRedDot.html">wx.hideTabBarRedDot(Object
        object)</a></div>
    <h3><a
        href="https://developers.weixin.qq.com/miniprogram/dev/api/ui/tab-bar/wx.showTabBar.html">wx.showTabBar(Object
        object)</a></h3>
    <div>. 显示 tabBar</div>
    <div>. 与之对应的隐藏 <a
        href="https://developers.weixin.qq.com/miniprogram/dev/api/ui/tab-bar/wx.hideTabBar.html">wx.hideTabBar(Object
        object)</a></div>
    <h3><a
        href="https://developers.weixin.qq.com/miniprogram/dev/api/ui/tab-bar/wx.setTabBarBadge.html">wx.setTabBarBadge(Object
        object)</a></h3>
    <ul>
      <li>为 tabBar 某一项的右上角添加文本；字符串类型；数字必须显示的转换为字符串</li>
      <li>与之对应的移除 <a
          href="https://developers.weixin.qq.com/miniprogram/dev/api/ui/tab-bar/wx.removeTabBarBadge.html">wx.removeTabBarBadge(Object
          object)</a></li>
      <div>[<span class="iconfont icon-keyboard"></span>] 显示购物车商品数量</div>
      <pre>
wx.setTabBarBadge({
  index: 1,
  text: String(carts.length),
  success: res => console.log(res),
  fail: err => console.log(err),
  complete: () => console.log('done')
})</pre>
    </ul>
  </section>
  <h2>下拉刷新 PullDownRefresh</h2>
  <section>
    <h3><a
        href="https://developers.weixin.qq.com/miniprogram/dev/api/ui/pull-down-refresh/wx.startPullDownRefresh.html">
        wx.startPullDownRefresh(Object object)</a></h3>
    <ul>
      <li>开始下拉刷新。调用后触发下拉刷新动画，效果与用户手动下拉刷新一致</li>
      <li>在Page顶级 top-level 中使用</li>
      <li>与之对应的停止/结束刷新 <a
          href="https://developers.weixin.qq.com/miniprogram/dev/api/ui/pull-down-refresh/wx.startPullDownRefresh.html">wx.startPullDownRefresh(Object
          object)</a></li>
      <li>使用效果同 <a href="./page_event.html">页面事件</a></li>
    </ul>
  </section>
  <h2>滚动 Scroll</h2>
  <section>
    <div>. 实现页面或部分内容的滚动</div>
    <h3><a
        href="https://developers.weixin.qq.com/miniprogram/dev/api/ui/scroll/wx.pageScrollTo.html">wx.pageScrollTo(Object
        object)</a></h3>
    <ul>
      <li>将页面滚动到目标位置，支持 <span class="warn">选择器</span> 和 <span class="warn">滚动距离</span> 两种方式定位；2选1</li>
      <li>深层嵌套中，配合 <a
          href="https://developers.weixin.qq.com/miniprogram/dev/api/wxml/wx.createSelectorQuery.html">wx.createSelectorQuery()</a>
        获取节点信息，实现更精确的滚动定位</li>
    </ul>
    <table>
      <caption>pageScrollTo常用属性</caption>
      <thead>
        <tr>
          <th>item</th>
          <th>desc</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>scrollTop</td>
          <td>滚动到 <span class="warn">页面</span> 的目标位置；单位 px</td>
        </tr>
        <tr>
          <td>duration</td>
          <td>滚动动画时长；单位 ms；默认300</td>
        </tr>
        <tr>
          <td>selector</td>
          <td>选择器；仅仅支持ID、类、后代、并列等 <a href="../web/selector.html">基本选择器</a></td>
        </tr>
        <tr>
          <td>offsetTop</td>
          <td>偏移距离，需要 <span class="warn">搭配</span> selector 参数使用，可以滚动到 selector 加偏移距离的位置，单位 px</td>
        </tr>
      </tbody>
    </table>
    <div>[<span class="iconfont icon-keyboard"></span>] 返回顶部 - 到页面0的位置；使用距离</div>
    <ul>
      <li>将某个元素 <a href="../web/fixed.html">固定定位 - fixed</a> 在页面底部并绑定事件</li>
      <pre>
wx.pageScrollTo({
    scrollTop: 0,
    duration: 300,
    success: res => console.log(res),
    fail: err => console.log(err),
    complete: () => console.log('scroll done')
})</pre>
    </ul>
    <div>[<span class="iconfont icon-keyboard"></span>] 页面滚动到某个元素 - 使用选择器</div>
    <ul>
      <li>页面结构 wxml</li>
      <pre>
&lt;view class="wrap"&gt;
    &lt;view class="header"&gt;&lt;/view&gt;
    &lt;view class="nav"&gt;&lt;/view&gt;
    &lt;view class="cont"&gt;&lt;/view&gt;
    &lt;view class="footer"&gt;&lt;/view&gt;
    &lt;view class="backToNav" bind:tap="toNav"&gt;返回主菜单&lt;/view&gt;
&lt;/view&gt;</pre>
      <li>页面逻辑 js </li>
      <pre>
toNav(){
    wx.pageScrollTo({
        selector:'.nav',
        // offsetTop: 100, // 返回到距离元素顶部100px的位置
        duration: 300,
        success: res => console.log(res),
        fail: err => console.log(err),
        complete: () => console.log('scroll done')
    })
}</pre>
    </ul>
    <div>[<span class="iconfont icon-keyboard"></span>] <a href="./case9.html">美食地图</a> - 增加导航菜单，分类美食，单击菜单跳转到对应的分类
    </div>
  </section>
  <div id="footer"></div>
  <script src="/utils/custom/footer.js"></script>
</body>

</html>