<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>内联框架 Iframe</title>
  <link rel="stylesheet" href="./css/styleNew.css">
  <style>
    .a-wrap {
      display: flex;
      gap: 1rem;
      margin: 1rem auto;
    }

    .a-wrap h2 {
      margin-right: auto;
    }

    .a-wrap a {
      color: #333;
      text-decoration: none;
      text-transform: uppercase;
    }

    .a-wrap a:hover {
      color: #f40;
    }
  </style>
</head>

<body>
  <header>
    <h1>&commat;iframe</h1>
    <span class="ham iconfont icon-menu"></span>
    <ul class="nav">
      <li class="nav-item">概述</li>
      <li class="nav-item">模块复用</li>
      <li class="nav-item">按需加载</li>
      <li class="nav-item">安全域</li>
    </ul>
  </header>
  <dl>
    <dt class="nav-cont">概述</dt>
    <dd>. inline frame；inline，同&lt;img&gt;一样，可以设置宽度</dd>
    <dd>. 在当前H5网页中嵌入网内或网外其他页面，如各大邮箱门户网站；有利于页面集成/模块复用，如顶部的导航栏、底部的版权信息栏</dd>
    <dd>. 除了嵌入页面，还可以嵌入PDF文件，实现在线预览的功能</dd>
    <dd>. Web开发中最古老、最简单的内容嵌入技术之一，时至今日仍被使用</dd>
    <dd>. 默认大小是300*150</dd>
    <dd>. 每个&lt;iframe&gt;元素形成自己的窗口，即有自己的window对象</dd>
    <dd>. 重载页面时不需要重载整个页面，只需要重载页面中的一个框架页</dd>
    <dd>. 超宽屏系统监测时，除了使用多信源，还可以使用&lt;iframe&gt;</dd>
    <dd>. 框架开发中，由于广泛采用了组件策略，很少使用该技术</dd>
    <dd>. 应提前制作好被嵌入的页面</dd>
    <dt>语法</dt>
    <dd>
      <pre>&lt;iframe src="" frameborder="0"&gt;&lt;/iframe&gt;</pre>
    </dd>
    <dt>属性</dt>
    <dd>
      <table>
        <tr>
          <th>类别</th>
          <th>说明</th>
        </tr>
        <tr>
          <td>src</td>
          <td>内框架的地址</td>
        </tr>
        <tr>
          <td>frameborder</td>
          <td>是否显示边框，1(yes),0(no)</td>
        </tr>
        <tr>
          <td>name</td>
          <td>框架名字，方便js操作；给&lt;a&gt;提供链接</td>
        </tr>
        <tr>
          <td>scrolling</td>
          <td>超过默认大小时，是否滚动，默认带滚动yes；no不带滚动</td>
        </tr>
        <tr>
          <td>width</td>
          <td>框架宽度，不带单位，建议使用css设置</td>
        </tr>
        <tr>
          <td>height</td>
          <td>框架高度，不带单位，建议使用css设置</td>
        </tr>
        <tr>
          <td>title</td>
          <td>框架提示信息，桌面端应用建议加上该属性</td>
        </tr>
      </table>
    </dd>
    <dd class="mt2">[<span class="iconfont icon-keyboard"></span>]引用B站视频-分享-嵌入代码</dd>
    <dd>
      <iframe class="iframe-b"
        src="//player.bilibili.com/player.html?aid=20762083&bvid=BV1TW411p7cv&cid=34000759&page=1" scrolling="no"
        border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe>
    </dd>
    <dd class="mt2">[<span class="iconfont icon-keyboard"></span>]嵌入PDF</dd>
    <dd>.适合桌面端；移动端会提示会自动下载</dd>
    <dd>.使用专门的js库在线预览</dd>
    <dd>
      <pre>
&lt;iframe src="xxx.pdf" frameborder="0"&gt;&lt;/iframe&gt;</pre>
    </dd>
  </dl>
  <div class="chap nav-cont">模块复用</div>
  <dl>
    <dd>. 多次使用某个功能模块，如导航、版权等重复性内容</dd>
    <dd>. 可以和当前页面交换数据/动态复用；也可以单纯的复用模块/静态复用</dd>
    <dd>. 为完整显示加载页面,避免出现滚动条，通常根据加载页面的大小，指定框架的高度；也使用onload动态获取高度；实际渲染效果，受页面加载影响</dd>
    <dd>. 利用CSS指定高度加载；还应该考虑媒体自适应/适配不同终端的情况</dd>
    <dt>[<span class="iconfont icon-keyboard"></span>] 复用底部footer-静态复用</dt>
    <dt>阶段1</dt>
    <dd>1. 新建H5项目</dd>
    <dd>2. 准备底部footer.html，使用&lt;footer&gt;展示版权信息或使用lorem占位符代替，并使用CSS水平居中</dd>
    <dd>
      <pre>
footer {
  text-align: center;
}</pre>
    </dd>
    <dd>3. 新建html页面，如index.html，添加&lt;iframe&gt;并指定src为footer.html；注意路径的使用</dd>
    <dd>
      <pre>&lt;iframe src="./footer.html" frameborder="1"&gt;&lt;/iframe&gt;</pre>
    </dd>
    <dd>4. 以内部样式的形式，为&lt;iframe&gt;添加宽度样式，更加符合目标页面的需要</dd>
    <dd>
      <pre>
iframe {
  width: 100%;
}</pre>
    </dd>
    <dd>5. 在index.html中右键单击，选择open with live server，打开浏览器，查看页面渲染效果</dd>
    <dt>阶段2</dt>
    <dd>. 嵌入页面内容过多时，超过默认大小，出现滚动条，影响用户体验</dd>
    <dd>1. 取消&lt;iframe&gt;的默认滚动条[设置scrolling='no']</dd>
    <dd>2. 在目标页中使用CSS指定嵌入页面内容的实际高度，也可以使用js动态获取</dd>
    <dd>[<span class="iconfont icon-bangzhu2"></span>]</dd>
    <dd>. 如何知道嵌入页面高度?</dd>
    <dd>. 如果嵌入页面的内容高度是300px，那么目标页面设置的高度是多少?为什么?怎么处理?</dd>
    <dd>
      <pre>
iframe {
  width: 100%;
  height: 300px;//
}</pre>
    </dd>
  </dl>
  <div class="chap nav-cont">按需加载</div>
  <dl>
    <dt>说明</dt>
    <dd>. &lt;a&gt;中，href属性指定的内容，可以在当前页面打开，也可以在新页面打开，还可以在&lt;iframe&gt;中打开；利用这个特点，可以动态/按需加载页面</dd>
    <dd class="mt2">[<span class="iconfont icon-keyboard"></span>] 按需加载</dd>
    <dd>1. 新建H5项目</dd>
    <dd>2. 创建诺干需要加载的.html页面，内容以占位符lorem代替</dd>
    <dd>3. 新建index.html文件，添加&lt;iframe&gt;，指定name属性为cont，并设置其样式，如宽度、高度</dd>
    <dd>4. 在&lt;iframe&gt;上方继续创建诺干&lt;a&gt;，分别指定href属性为对应的.html页面，指定target为&lt;iframe&gt;的name：cont</dd>
    <dd class="demo-title">参考HTML</dd>
    <dd>
      <pre>
&lt;a href="./table.html" target="cont">table&lt;/a&gt;
//...
&lt;iframe src="xxx.html" name="cont" frameborder="0" scrolling="no"&gt;&lt;/iframe&gt;</pre>
    </dd>
    <dd>5. 调整各页面样式至合适；在index.html中，右键单击，选择open with live server，打开浏览器，单击&lt;a&gt;，查看页面动态加载效果</dd>
  </dl>
  <div class="chap nav-cont">安全域 Domain</div>
  <dl>
    <dd class="mt2">[<span class="iconfont icon-keyboard"></span>] 跨域加载</dd>
    <dd>. 加载百度到当前域名网站内，会提示如下信息，表示百度被设置为禁止内嵌</dd>
    <dd>[ <span class="iconfont icon-bomb"></span> ]如果百度在其网站内部设置了恶意代码。。。</dd>
    <dd>
      <pre>
&lt;iframe src="https://www.baidu.com" frameborder="0" scrolling="no" title="baidu"&gt;&lt;/iframe&gt;</pre>
    </dd>
    <dd>
      <pre>Refused to display 'https://www.baidu.com/' in a frame because it set 'X-Frame-Options' to 'sameorigin'.</pre>
    </dd>
    <dt>sandbox</dt>
    <dd>. &lt;iframe&gt;的安全属性，对其使用进行限制</dd>
    <dd>. script脚本不能执行</dd>
    <dd>. 不能发送ajax请求</dd>
    <dd>. 不能使用本地存储，即localStorage,cookie等</dd>
    <dd>. 不能创建新的弹窗和window</dd>
    <dd>. 不能发送表单</dd>
    <dd>. 不能加载额外插件比如flash等</dd>
    <dd>
      <table>
        <tr>
          <th>类别</th>
          <th>说明</th>
        </tr>
        <tr>
          <td>""</td>
          <td>启用所有限制条件</td>
        </tr>
        <tr>
          <td>allow-same-origin</td>
          <td>允许将内容作为普通来源对待。如果未使用该关键字，嵌入的内容将被视为一个独立的源</td>
        </tr>
        <tr>
          <td>allow-top-navigation</td>
          <td>嵌入的页面的上下文可以导航（加载）内容到顶级的浏览上下文环境（browsing context）。如果未使用该关键字，这个操作将不可用</td>
        </tr>
        <tr>
          <td>allow-forms</td>
          <td>允许表单提交</td>
        </tr>
        <tr>
          <td>allow-scripts</td>
          <td>允许脚本执行</td>
        </tr>
      </table>
    </dd>
    <dt>同域-In/Same Domain</dt>
    <dd>. 协议相同</dd>
    <dd>. 域名相同</dd>
    <dd>. 端口相同</dd>
    <dd>目的：保证用户信息的安全，防止恶意的网站窃取数据</dd>
    <dd>非常必需；否则 Cookie 可以共享，互联网就毫无安全可言</dd>
    <dd>可以简单理解为是同一个网站/域名/网站内部</dd>
    <dt>跨域-Cross Domain</dt>
    <dd>. 不同的网站/域名</dd>
    <dd>. 默认情况下，仅仅支持同域页面加载，跨越加载会告警</dd>
    <dd>. 同域情况下，父窗口和子窗口可以互相通信；如果跨域，则无法通信</dd>
    <dd class="mt2">[<span class="iconfont icon-keyboard"></span>] 示例</dd>
    <dd>http://www.example.com/dir/page.html</dd>
    <dd>. 协议：http</dd>
    <dd>. 域名：www.example.com</dd>
    <dd>. 端口：80（默认端口，可以省略）</dd>
    <dd>
      <pre>
<span>http://www.example.com/dir2/other.html：同源</span>
<span>http://example.com/dir/other.html：不同源（域名不同）</span>
<span>http://v2.www.example.com/dir/other.html：不同源（域名不同）</span>
<span>http://www.example.com:81/dir/other.html：不同源（端口不同）</span>
<span>https://www.example.com/dir/page.html：不同源（协议不同）</span></pre>
    </dd>
    <dt>其它使用</dt>
    <dd>当前页面可以访问加载页面的DOM和cookie</dd>
    <dd>
      <pre>
let iframe = document.getElementById("footer");
iframe.onload = function () {
    let doc = iframe.contentWindow.document;
    console.log(doc.getElementById('author').innerHTML);
    console.log(document.cookie);
}</pre>
    </dd>
  </dl>
  <div class="chap">总结与作业 Summary & Homework</div>
  <dl>
    <dt>总结</dt>
    <dd>. &lt;iframe&gt;的同域使用</dd>
    <dd class="quote">
      <div>. 使用iframe要防止被iframe：页面被运行商劫持了，被挂上/注入不知名的野鸡广告</div>
      <div>. 很多非法网站让人防不胜防的小广告，大多都是iframe实现的</div>
    </dd>
    <dt>作业</dt>
    <dd>. 使用&lt;iframe&gt;制作底部版权信息来优化个人网站</dd>
  </dl>
  <iframe src="../../common/Html.html" frameborder="0" scrolling="no" title="html" id="html"
    onload="this.height=this.contentDocument.body.scrollHeight"></iframe>
  <div id="footer"></div>
  <script src="/utils/custom/footer.js"></script>
  <script src="./lib/ham.js"></script>
  <script>
    let iframe = document.getElementById("footer");
    iframe.onload = function () {
      let doc = iframe.contentWindow.document;
      console.log(doc.getElementById('author').innerHTML);
      console.log(document.cookie);
    }
  </script>
</body>

</html>